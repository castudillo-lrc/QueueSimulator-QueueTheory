window.Modernizr=function(t,e,i){function n(t){v.cssText=t}function r(t,e){return n(w.join(t+";")+(e||""))}function s(t,e){return typeof t===e}function o(t,e){return!!~(""+t).indexOf(e)}function a(t,e){for(var n in t){var r=t[n];if(!o(r,"-")&&v[r]!==i)return"pfx"==e?r:!0}return!1}function l(t,e,n){for(var r in t){var o=e[t[r]];if(o!==i)return n===!1?t[r]:s(o,"function")?o.bind(n||e):o}return!1}function c(t,e,i){var n=t.charAt(0).toUpperCase()+t.slice(1),r=(t+" "+E.join(n+" ")+n).split(" ");return s(e,"string")||s(e,"undefined")?a(r,e):(r=(t+" "+S.join(n+" ")+n).split(" "),l(r,e,i))}function h(){p.input=function(i){for(var n=0,r=i.length;r>n;n++)q[i[n]]=!!(i[n]in b);return q.list&&(q.list=!(!e.createElement("datalist")||!t.HTMLDataListElement)),q}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),p.inputtypes=function(t){for(var n,r,s,o=0,a=t.length;a>o;o++)b.setAttribute("type",r=t[o]),n="text"!==b.type,n&&(b.value=x,b.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(r)&&b.style.WebkitAppearance!==i?(g.appendChild(b),s=e.defaultView,n=s.getComputedStyle&&"textfield"!==s.getComputedStyle(b,null).WebkitAppearance&&0!==b.offsetHeight,g.removeChild(b)):/^(search|tel)$/.test(r)||(n=/^(url|email)$/.test(r)?b.checkValidity&&b.checkValidity()===!1:b.value!=x)),F[t[o]]=!!n;return F}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var u,f,d="2.8.3",p={},m=!0,g=e.documentElement,_="modernizr",y=e.createElement(_),v=y.style,b=e.createElement("input"),x=":)",A={}.toString,w=" -webkit- -moz- -o- -ms- ".split(" "),k="Webkit Moz O ms",E=k.split(" "),S=k.toLowerCase().split(" "),C={svg:"http://www.w3.org/2000/svg"},M={},F={},q={},P=[],R=P.slice,O=function(t,i,n,r){var s,o,a,l,c=e.createElement("div"),h=e.body,u=h||e.createElement("body");if(parseInt(n,10))for(;n--;)a=e.createElement("div"),a.id=r?r[n]:_+(n+1),c.appendChild(a);return s=["&#173;",'<style id="s',_,'">',t,"</style>"].join(""),c.id=_,(h?c:u).innerHTML+=s,u.appendChild(c),h||(u.style.background="",u.style.overflow="hidden",l=g.style.overflow,g.style.overflow="hidden",g.appendChild(u)),o=i(c,t),h?c.parentNode.removeChild(c):(u.parentNode.removeChild(u),g.style.overflow=l),!!o},T=function(e){var i=t.matchMedia||t.msMatchMedia;if(i)return i(e)&&i(e).matches||!1;var n;return O("@media "+e+" { #"+_+" { position: absolute; } }",function(e){n="absolute"==(t.getComputedStyle?getComputedStyle(e,null):e.currentStyle).position}),n},j=function(){function t(t,r){r=r||e.createElement(n[t]||"div"),t="on"+t;var o=t in r;return o||(r.setAttribute||(r=e.createElement("div")),r.setAttribute&&r.removeAttribute&&(r.setAttribute(t,""),o=s(r[t],"function"),s(r[t],"undefined")||(r[t]=i),r.removeAttribute(t))),r=null,o}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t}(),B={}.hasOwnProperty;f=s(B,"undefined")||s(B.call,"undefined")?function(t,e){return e in t&&s(t.constructor.prototype[e],"undefined")}:function(t,e){return B.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=R.call(arguments,1),n=function(){if(this instanceof n){var r=function(){};r.prototype=e.prototype;var s=new r,o=e.apply(s,i.concat(R.call(arguments)));return Object(o)===o?o:s}return e.apply(t,i.concat(R.call(arguments)))};return n}),M.flexbox=function(){return c("flexWrap")},M.flexboxlegacy=function(){return c("boxDirection")},M.canvas=function(){var t=e.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},M.canvastext=function(){return!(!p.canvas||!s(e.createElement("canvas").getContext("2d").fillText,"function"))},M.webgl=function(){return!!t.WebGLRenderingContext},M.touch=function(){var i;return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch?i=!0:O(["@media (",w.join("touch-enabled),("),_,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(t){i=9===t.offsetTop}),i},M.geolocation=function(){return"geolocation"in navigator},M.postmessage=function(){return!!t.postMessage},M.websqldatabase=function(){return!!t.openDatabase},M.indexedDB=function(){return!!c("indexedDB",t)},M.hashchange=function(){return j("hashchange",t)&&(e.documentMode===i||e.documentMode>7)},M.history=function(){return!(!t.history||!history.pushState)},M.draganddrop=function(){var t=e.createElement("div");return"draggable"in t||"ondragstart"in t&&"ondrop"in t},M.websockets=function(){return"WebSocket"in t||"MozWebSocket"in t},M.rgba=function(){return n("background-color:rgba(150,255,150,.5)"),o(v.backgroundColor,"rgba")},M.hsla=function(){return n("background-color:hsla(120,40%,100%,.5)"),o(v.backgroundColor,"rgba")||o(v.backgroundColor,"hsla")},M.multiplebgs=function(){return n("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(v.background)},M.backgroundsize=function(){return c("backgroundSize")},M.borderimage=function(){return c("borderImage")},M.borderradius=function(){return c("borderRadius")},M.boxshadow=function(){return c("boxShadow")},M.textshadow=function(){return""===e.createElement("div").style.textShadow},M.opacity=function(){return r("opacity:.55"),/^0.55$/.test(v.opacity)},M.cssanimations=function(){return c("animationName")},M.csscolumns=function(){return c("columnCount")},M.cssgradients=function(){var t="background-image:",e="gradient(linear,left top,right bottom,from(#9f9),to(white));",i="linear-gradient(left top,#9f9, white);";return n((t+"-webkit- ".split(" ").join(e+t)+w.join(i+t)).slice(0,-t.length)),o(v.backgroundImage,"gradient")},M.cssreflections=function(){return c("boxReflect")},M.csstransforms=function(){return!!c("transform")},M.csstransforms3d=function(){var t=!!c("perspective");return t&&"webkitPerspective"in g.style&&O("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(e,i){t=9===e.offsetLeft&&3===e.offsetHeight}),t},M.csstransitions=function(){return c("transition")},M.fontface=function(){var t;return O('@font-face {font-family:"font";src:url("https://")}',function(i,n){var r=e.getElementById("smodernizr"),s=r.sheet||r.styleSheet,o=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"";t=/src/i.test(o)&&0===o.indexOf(n.split(" ")[0])}),t},M.generatedcontent=function(){var t;return O(["#",_,"{font:0/0 a}#",_,':after{content:"',x,'";visibility:hidden;font:3px/1 a}'].join(""),function(e){t=e.offsetHeight>=3}),t},M.video=function(){var t=e.createElement("video"),i=!1;try{(i=!!t.canPlayType)&&(i=new Boolean(i),i.ogg=t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i},M.audio=function(){var t=e.createElement("audio"),i=!1;try{(i=!!t.canPlayType)&&(i=new Boolean(i),i.ogg=t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),i.m4a=(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return i},M.localstorage=function(){try{return localStorage.setItem(_,_),localStorage.removeItem(_),!0}catch(t){return!1}},M.sessionstorage=function(){try{return sessionStorage.setItem(_,_),sessionStorage.removeItem(_),!0}catch(t){return!1}},M.webworkers=function(){return!!t.Worker},M.applicationcache=function(){return!!t.applicationCache},M.svg=function(){return!!e.createElementNS&&!!e.createElementNS(C.svg,"svg").createSVGRect},M.inlinesvg=function(){var t=e.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==C.svg},M.smil=function(){return!!e.createElementNS&&/SVGAnimate/.test(A.call(e.createElementNS(C.svg,"animate")))},M.svgclippaths=function(){return!!e.createElementNS&&/SVGClipPath/.test(A.call(e.createElementNS(C.svg,"clipPath")))};for(var U in M)f(M,U)&&(u=U.toLowerCase(),p[u]=M[U](),P.push((p[u]?"":"no-")+u));return p.input||h(),p.addTest=function(t,e){if("object"==typeof t)for(var n in t)f(t,n)&&p.addTest(n,t[n]);else{if(t=t.toLowerCase(),p[t]!==i)return p;e="function"==typeof e?e():e,"undefined"!=typeof m&&m&&(g.className+=" "+(e?"":"no-")+t),p[t]=e}return p},n(""),y=b=null,function(t,e){function i(t,e){var i=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return i.innerHTML="x<style>"+e+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var t=y.elements;return"string"==typeof t?t.split(" "):t}function r(t){var e=_[t[m]];return e||(e={},g++,t[m]=g,_[g]=e),e}function s(t,i,n){if(i||(i=e),h)return i.createElement(t);n||(n=r(i));var s;return s=n.cache[t]?n.cache[t].cloneNode():p.test(t)?(n.cache[t]=n.createElem(t)).cloneNode():n.createElem(t),!s.canHaveChildren||d.test(t)||s.tagUrn?s:n.frag.appendChild(s)}function o(t,i){if(t||(t=e),h)return t.createDocumentFragment();i=i||r(t);for(var s=i.frag.cloneNode(),o=0,a=n(),l=a.length;l>o;o++)s.createElement(a[o]);return s}function a(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(i){return y.shivMethods?s(i,t,e):e.createElem(i)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(y,e.frag)}function l(t){t||(t=e);var n=r(t);return!y.shivCSS||c||n.hasCSS||(n.hasCSS=!!i(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),h||a(t,n),t}var c,h,u="3.7.0",f=t.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",g=0,_={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",c="hidden"in t,h=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(i){c=!0,h=!0}}();var y={elements:f.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:u,shivCSS:f.shivCSS!==!1,supportsUnknownElements:h,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:l,createElement:s,createDocumentFragment:o};t.html5=y,l(e)}(this,e),p._version=d,p._prefixes=w,p._domPrefixes=S,p._cssomPrefixes=E,p.mq=T,p.hasEvent=j,p.testProp=function(t){return a([t])},p.testAllProps=c,p.testStyles=O,p.prefixed=function(t,e,i){return e?c(t,e,i):c(t,"pfx")},g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(m?" js "+P.join(" "):""),p}(this,this.document),function(){function t(t){return function(e,i,n,r){i=y(i,r,4);var s=!E(e)&&_.keys(e),o=(s||e).length,a=t>0?0:o-1;3>arguments.length&&(n=e[s?s[a]:a],a+=t);for(var l=i,c=n;a>=0&&o>a;a+=t)var h=s?s[a]:a,c=l(c,e[h],h,e);return c}}function e(t){return function(e,i,n){i=v(i,n),n=k(e);for(var r=t>0?0:n-1;r>=0&&n>r;r+=t)if(i(e[r],r,e))return r;return-1}}function i(t,e,i){return function(n,r,s){var o=0,a=k(n);if("number"==typeof s)t>0?o=s>=0?s:Math.max(s+a,o):a=s>=0?Math.min(s+1,a):s+a+1;else if(i&&s&&a)return s=i(n,r),n[s]===r?s:-1;if(r!==r)return s=e(c.call(n,o,a),_.isNaN),s>=0?s+o:-1;for(s=t>0?o:a-1;s>=0&&a>s;s+=t)if(n[s]===r)return s;return-1}}function n(t,e){var i=q.length,n=t.constructor,n=_.isFunction(n)&&n.prototype||a,r="constructor";for(_.has(t,r)&&!_.contains(e,r)&&e.push(r);i--;)r=q[i],r in t&&t[r]!==n[r]&&!_.contains(e,r)&&e.push(r)}var r=this,s=r._,o=Array.prototype,a=Object.prototype,l=o.push,c=o.slice,h=a.toString,u=a.hasOwnProperty,f=Array.isArray,d=Object.keys,p=Function.prototype.bind,m=Object.create,g=function(){},_=function(t){return t instanceof _?t:this instanceof _?void(this._wrapped=t):new _(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):r._=_,_.VERSION="1.8.3";var y=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,s){return t.call(e,i,n,r,s)}}return function(){return t.apply(e,arguments)}},v=function(t,e,i){return null==t?_.identity:_.isFunction(t)?y(t,e,i):_.isObject(t)?_.matcher(t):_.property(t)};_.iteratee=function(t,e){return v(t,e,1/0)};var b=function(t,e){return function(i){var n=arguments.length;if(2>n||null==i)return i;for(var r=1;n>r;r++)for(var s=arguments[r],o=t(s),a=o.length,l=0;a>l;l++){var c=o[l];e&&void 0!==i[c]||(i[c]=s[c])}return i}},x=function(t){return _.isObject(t)?m?m(t):(g.prototype=t,t=new g,g.prototype=null,t):{}},A=function(t){return function(e){return null==e?void 0:e[t]}},w=Math.pow(2,53)-1,k=A("length"),E=function(t){return t=k(t),"number"==typeof t&&t>=0&&w>=t};_.each=_.forEach=function(t,e,i){e=y(e,i);var n;if(E(t))for(i=0,n=t.length;n>i;i++)e(t[i],i,t);else{var r=_.keys(t);for(i=0,n=r.length;n>i;i++)e(t[r[i]],r[i],t)}return t},_.map=_.collect=function(t,e,i){e=v(e,i),i=!E(t)&&_.keys(t);for(var n=(i||t).length,r=Array(n),s=0;n>s;s++){var o=i?i[s]:s;r[s]=e(t[o],o,t)}return r},_.reduce=_.foldl=_.inject=t(1),_.reduceRight=_.foldr=t(-1),_.find=_.detect=function(t,e,i){return e=E(t)?_.findIndex(t,e,i):_.findKey(t,e,i),void 0!==e&&-1!==e?t[e]:void 0},_.filter=_.select=function(t,e,i){var n=[];return e=v(e,i),_.each(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n},_.reject=function(t,e,i){return _.filter(t,_.negate(v(e)),i)},_.every=_.all=function(t,e,i){e=v(e,i),i=!E(t)&&_.keys(t);for(var n=(i||t).length,r=0;n>r;r++){var s=i?i[r]:r;if(!e(t[s],s,t))return!1}return!0},_.some=_.any=function(t,e,i){e=v(e,i),i=!E(t)&&_.keys(t);for(var n=(i||t).length,r=0;n>r;r++){var s=i?i[r]:r;if(e(t[s],s,t))return!0}return!1},_.contains=_.includes=_.include=function(t,e,i,n){return E(t)||(t=_.values(t)),("number"!=typeof i||n)&&(i=0),0<=_.indexOf(t,e,i)},_.invoke=function(t,e){var i=c.call(arguments,2),n=_.isFunction(e);return _.map(t,function(t){var r=n?e:t[e];return null==r?r:r.apply(t,i)})},_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matcher(e))},_.findWhere=function(t,e){return _.find(t,_.matcher(e))},_.max=function(t,e,i){var n,r=-(1/0),s=-(1/0);if(null==e&&null!=t){t=E(t)?t:_.values(t);for(var o=0,a=t.length;a>o;o++)i=t[o],i>r&&(r=i)}else e=v(e,i),_.each(t,function(t,i,o){n=e(t,i,o),(n>s||-(1/0)===n&&-(1/0)===r)&&(r=t,s=n)});return r},_.min=function(t,e,i){var n,r=1/0,s=1/0;if(null==e&&null!=t){t=E(t)?t:_.values(t);for(var o=0,a=t.length;a>o;o++)i=t[o],r>i&&(r=i)}else e=v(e,i),_.each(t,function(t,i,o){n=e(t,i,o),(s>n||1/0===n&&1/0===r)&&(r=t,s=n)});return r},_.shuffle=function(t){t=E(t)?t:_.values(t);for(var e,i=t.length,n=Array(i),r=0;i>r;r++)e=_.random(0,r),e!==r&&(n[r]=n[e]),n[e]=t[r];return n},_.sample=function(t,e,i){return null==e||i?(E(t)||(t=_.values(t)),t[_.random(t.length-1)]):_.shuffle(t).slice(0,Math.max(0,e))},_.sortBy=function(t,e,i){return e=v(e,i),_.pluck(_.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var S=function(t){return function(e,i,n){var r={};return i=v(i,n),_.each(e,function(n,s){var o=i(n,s,e);t(r,n,o)}),r}};_.groupBy=S(function(t,e,i){_.has(t,i)?t[i].push(e):t[i]=[e]}),_.indexBy=S(function(t,e,i){t[i]=e}),_.countBy=S(function(t,e,i){_.has(t,i)?t[i]++:t[i]=1}),_.toArray=function(t){return t?_.isArray(t)?c.call(t):E(t)?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:E(t)?t.length:_.keys(t).length},_.partition=function(t,e,i){e=v(e,i);var n=[],r=[];return _.each(t,function(t,i,s){(e(t,i,s)?n:r).push(t)}),[n,r]},_.first=_.head=_.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:_.initial(t,t.length-e)},_.initial=function(t,e,i){return c.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},_.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:_.rest(t,Math.max(0,t.length-e))},_.rest=_.tail=_.drop=function(t,e,i){return c.call(t,null==e||i?1:e)},_.compact=function(t){return _.filter(t,_.identity)};var C=function(t,e,i,n){var r=[],s=0;n=n||0;for(var o=k(t);o>n;n++){var a=t[n];if(E(a)&&(_.isArray(a)||_.isArguments(a))){e||(a=C(a,e,i));var l=0,c=a.length;for(r.length+=c;c>l;)r[s++]=a[l++]}else i||(r[s++]=a)}return r};_.flatten=function(t,e){return C(t,e,!1)},_.without=function(t){return _.difference(t,c.call(arguments,1))},_.uniq=_.unique=function(t,e,i,n){_.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=v(i,n)),n=[];for(var r=[],s=0,o=k(t);o>s;s++){var a=t[s],l=i?i(a,s,t):a;e?((!s||r!==l)&&n.push(a),r=l):i?_.contains(r,l)||(r.push(l),n.push(a)):_.contains(n,a)||n.push(a)}return n},_.union=function(){return _.uniq(C(arguments,!0,!0))},_.intersection=function(t){for(var e=[],i=arguments.length,n=0,r=k(t);r>n;n++){var s=t[n];if(!_.contains(e,s)){for(var o=1;i>o&&_.contains(arguments[o],s);o++);o===i&&e.push(s)}}return e},_.difference=function(t){var e=C(arguments,!0,!0,1);return _.filter(t,function(t){return!_.contains(e,t)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(t){for(var e=t&&_.max(t,k).length||0,i=Array(e),n=0;e>n;n++)i[n]=_.pluck(t,n);return i},_.object=function(t,e){for(var i={},n=0,r=k(t);r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},_.findIndex=e(1),_.findLastIndex=e(-1),_.sortedIndex=function(t,e,i,n){i=v(i,n,1),e=i(e),n=0;for(var r=k(t);r>n;){var s=Math.floor((n+r)/2);i(t[s])<e?n=s+1:r=s}return n},_.indexOf=i(1,_.findIndex,_.sortedIndex),_.lastIndexOf=i(-1,_.findLastIndex),_.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1,e=Math.max(Math.ceil((e-t)/i),0);for(var n=Array(e),r=0;e>r;r++,t+=i)n[r]=t;return n};var M=function(t,e,i,n,r){return n instanceof e?(e=x(t.prototype),t=t.apply(e,r),_.isObject(t)?t:e):t.apply(i,r)};_.bind=function(t,e){if(p&&t.bind===p)return p.apply(t,c.call(arguments,1));if(!_.isFunction(t))throw new TypeError("Bind must be called on a function");var i=c.call(arguments,2),n=function(){return M(t,n,e,this,i.concat(c.call(arguments)))};return n},_.partial=function(t){var e=c.call(arguments,1),i=function(){for(var n=0,r=e.length,s=Array(r),o=0;r>o;o++)s[o]=e[o]===_?arguments[n++]:e[o];for(;n<arguments.length;)s.push(arguments[n++]);return M(t,i,this,this,s)};return i},_.bindAll=function(t){var e,i,n=arguments.length;if(1>=n)throw Error("bindAll must be passed function names");for(e=1;n>e;e++)i=arguments[e],t[i]=_.bind(t[i],t);return t},_.memoize=function(t,e){var i=function(n){var r=i.cache,s=""+(e?e.apply(this,arguments):n);return _.has(r,s)||(r[s]=t.apply(this,arguments)),r[s]};return i.cache={},i},_.delay=function(t,e){var i=c.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},_.defer=_.partial(_.delay,_,1),_.throttle=function(t,e,i){var n,r,s,o=null,a=0;i||(i={});var l=function(){a=!1===i.leading?0:_.now(),o=null,s=t.apply(n,r),o||(n=r=null)};return function(){var c=_.now();!a&&!1===i.leading&&(a=c);var h=e-(c-a);return n=this,r=arguments,0>=h||h>e?(o&&(clearTimeout(o),o=null),a=c,s=t.apply(n,r),o||(n=r=null)):!o&&!1!==i.trailing&&(o=setTimeout(l,h)),s}},_.debounce=function(t,e,i){var n,r,s,o,a,l=function(){var c=_.now()-o;e>c&&c>=0?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(s,r),n||(s=r=null)))};return function(){s=this,r=arguments,o=_.now();var c=i&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(s,r),s=r=null),a}},_.wrap=function(t,e){return _.partial(e,t)},_.negate=function(t){return function(){return!t.apply(this,arguments)}},_.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},_.after=function(t,e){return function(){return 1>--t?e.apply(this,arguments):void 0}},_.before=function(t,e){var i;return function(){return 0<--t&&(i=e.apply(this,arguments)),1>=t&&(e=null),i}},_.once=_.partial(_.before,2);var F=!{toString:null}.propertyIsEnumerable("toString"),q="valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" ");_.keys=function(t){if(!_.isObject(t))return[];if(d)return d(t);var e,i=[];for(e in t)_.has(t,e)&&i.push(e);return F&&n(t,i),i},_.allKeys=function(t){if(!_.isObject(t))return[];var e,i=[];for(e in t)i.push(e);return F&&n(t,i),i},_.values=function(t){for(var e=_.keys(t),i=e.length,n=Array(i),r=0;i>r;r++)n[r]=t[e[r]];return n},_.mapObject=function(t,e,i){e=v(e,i),i=_.keys(t);for(var n,r=i.length,s={},o=0;r>o;o++)n=i[o],s[n]=e(t[n],n,t);return s},_.pairs=function(t){for(var e=_.keys(t),i=e.length,n=Array(i),r=0;i>r;r++)n[r]=[e[r],t[e[r]]];return n},_.invert=function(t){for(var e={},i=_.keys(t),n=0,r=i.length;r>n;n++)e[t[i[n]]]=i[n];return e},_.functions=_.methods=function(t){var e,i=[];for(e in t)_.isFunction(t[e])&&i.push(e);return i.sort()},_.extend=b(_.allKeys),_.extendOwn=_.assign=b(_.keys),_.findKey=function(t,e,i){e=v(e,i),i=_.keys(t);for(var n,r=0,s=i.length;s>r;r++)if(n=i[r],e(t[n],n,t))return n},_.pick=function(t,e,i){var n,r,s={},o=t;if(null==o)return s;_.isFunction(e)?(r=_.allKeys(o),n=y(e,i)):(r=C(arguments,!1,!1,1),n=function(t,e,i){return e in i},o=Object(o));for(var a=0,l=r.length;l>a;a++){var c=r[a],h=o[c];n(h,c,o)&&(s[c]=h)}return s},_.omit=function(t,e,i){if(_.isFunction(e))e=_.negate(e);else{var n=_.map(C(arguments,!1,!1,1),String);e=function(t,e){return!_.contains(n,e)}}return _.pick(t,e,i)},_.defaults=b(_.allKeys,!0),_.create=function(t,e){var i=x(t);return e&&_.extendOwn(i,e),i},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t},_.isMatch=function(t,e){var i=_.keys(e),n=i.length;if(null==t)return!n;for(var r=Object(t),s=0;n>s;s++){var o=i[s];if(e[o]!==r[o]||!(o in r))return!1}return!0};var P=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var r=h.call(t);if(r!==h.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}if(r="[object Array]"===r,!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,o=e.constructor;if(s!==o&&(!_.isFunction(s)||!(s instanceof s&&_.isFunction(o)&&o instanceof o))&&"constructor"in t&&"constructor"in e)return!1}for(i=i||[],n=n||[],s=i.length;s--;)if(i[s]===t)return n[s]===e;if(i.push(t),n.push(e),r){if(s=t.length,s!==e.length)return!1;for(;s--;)if(!P(t[s],e[s],i,n))return!1}else{if(r=_.keys(t),s=r.length,_.keys(e).length!==s)return!1;for(;s--;)if(o=r[s],!_.has(e,o)||!P(t[o],e[o],i,n))return!1}return i.pop(),n.pop(),!0};_.isEqual=function(t,e){return P(t,e)},_.isEmpty=function(t){return null==t?!0:E(t)&&(_.isArray(t)||_.isString(t)||_.isArguments(t))?0===t.length:0===_.keys(t).length},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=f||function(t){return"[object Array]"===h.call(t)},_.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},_.each("Arguments Function String Number Date RegExp Error".split(" "),function(t){_["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),_.isArguments(arguments)||(_.isArguments=function(t){return _.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(t){return"function"==typeof t||!1}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!==+t},_.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){return null!=t&&u.call(t,e)},_.noConflict=function(){return r._=s,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.noop=function(){},_.property=A,_.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},_.matcher=_.matches=function(t){return t=_.extendOwn({},t),function(e){return _.isMatch(e,t)}},_.times=function(t,e,i){var n=Array(Math.max(0,t));for(e=y(e,i,1),i=0;t>i;i++)n[i]=e(i);return n},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()},f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},b=_.invert(f),A=function(t){var e=function(e){return t[e]},i="(?:"+_.keys(t).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(r,e):t}},_.escape=A(f),_.unescape=A(b),_.result=function(t,e,i){return e=null==t?void 0:t[e],void 0===e&&(e=i),_.isFunction(e)?e.call(t):e};var R=0;_.uniqueId=function(t){var e=++R+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,T={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\u2028|\u2029/g,B=function(t){return"\\"+T[t]};_.template=function(t,e,i){!e&&i&&(e=i),e=_.defaults({},e,_.templateSettings),i=RegExp([(e.escape||O).source,(e.interpolate||O).source,(e.evaluate||O).source].join("|")+"|$","g");var n=0,r="__p+='";t.replace(i,function(e,i,s,o,a){return r+=t.slice(n,a).replace(j,B),n=a+e.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":s?r+="'+\n((__t=("+s+"))==null?'':__t)+\n'":o&&(r+="';\n"+o+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(o){throw o.source=r,o}return i=function(t){return s.call(this,t,_)},i.source="function("+(e.variable||"obj")+"){\n"+r+"}",i},_.chain=function(t){return t=_(t),t._chain=!0,t};var U=function(t,e){return t._chain?_(e).chain():e};_.mixin=function(t){_.each(_.functions(t),function(e){var i=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),U(this,i.apply(_,t))}})},_.mixin(_),_.each("pop push reverse shift sort splice unshift".split(" "),function(t){var e=o[t];_.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),("shift"===t||"splice"===t)&&0===i.length&&delete i[0],U(this,i)}}),_.each(["concat","join","slice"],function(t){var e=o[t];_.prototype[t]=function(){return U(this,e.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(){var t=this.Backbone||{};this.Backbone=t;var e=[].slice,i=function(t,e,i){var n;t=-1;var r=e.length;switch(i.length){case 0:for(;++t<r;)(n=e[t]).callback.call(n.ctx);break;case 1:for(;++t<r;)(n=e[t]).callback.call(n.ctx,i[0]);break;case 2:for(;++t<r;)(n=e[t]).callback.call(n.ctx,i[0],i[1]);break;case 3:for(;++t<r;)(n=e[t]).callback.call(n.ctx,i[0],i[1],i[2]);break;default:for(;++t<r;)(n=e[t]).callback.apply(n.ctx,i)}},n=t.Events={on:function(t,e,i){return this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){var n=this,r=_.once(function(){n.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,i),this},off:function(t,e,i){var n,r,s,o,a,l,c,h;if(!this._events)return this;if(!t&&!e&&!i)return this._events={},this;for(o=t?[t]:_.keys(this._events),a=0,l=o.length;l>a;a++)if(t=o[a],n=this._events[t]){if(s=[],e||i)for(c=0,h=n.length;h>c;c++)r=n[c],(e&&e!==(r.callback._callback||r.callback)||i&&i!==r.context)&&s.push(r);this._events[t]=s}return this},trigger:function(t){if(!this._events)return this;var n=e.call(arguments,1),r=this._events[t],s=this._events.all;return r&&i(this,r,n),s&&i(this,s,arguments),this},listenTo:function(t,e,i){var n=this._listeners||(this._listeners={}),r=t._listenerId||(t._listenerId=_.uniqueId("l"));return n[r]=t,t.on(e,i||this,this),this},stopListening:function(t,e,i){var n=this._listeners;if(n){if(t)t.off(e,i,this),!e&&!i&&delete n[t._listenerId];else{for(var r in n)n[r].off(null,null,this);this._listeners={}}return this}}};n.bind=n.on,n.unbind=n.off,"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Backbone=t):this.Backbone=t,"function"==typeof define&&define.amd&&define("backbone",[],function(){return t})}(),function(){function t(t){var n=(new Date).getTime(),r=Math.max(0,16-(n-i)),s=e.setTimeout(function(){t(n+r)},r);return i=n+r,s}for(var e=this,i=0,n=["ms","moz","webkit","o"],r=0;r<n.length&&!e.requestAnimationFrame;++r)e.requestAnimationFrame=e[n[r]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[n[r]+"CancelAnimationFrame"]||e[n[r]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=t),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(t){clearTimeout(t)}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e.requestAnimationFrame),exports.requestAnimationFrame=e.requestAnimationFrame):e.requestAnimationFrame=e.requestAnimationFrame,"function"==typeof define&&define.amd&&define("requestAnimationFrame",[],function(){return e.requestAnimationFrame})}(),function(t,e,i,n){function r(){var t=document.body.getBoundingClientRect(),e=this.width=t.width,t=this.height=t.height;this.renderer.setSize(e,t,this.ratio),this.trigger(y.Events.resize,e,t)}var s=this,o=Math.sin,a=Math.cos,l=Math.atan2,c=Math.sqrt,h=Math.PI,u=2*h,f=h/2,d=Math.pow,p=Math.min,m=Math.max,g=0,_={temp:document.createElement("div"),hasEventListeners:e.isFunction(s.addEventListener),bind:function(t,e,i,n){return this.hasEventListeners?t.addEventListener(e,i,!!n):t.attachEvent("on"+e,i),this},unbind:function(t,e,i,n){return this.hasEventListeners?t.removeEventListeners(e,i,!!n):t.detachEvent("on"+e,i),this}},y=s.Two=function(t){if(t=e.defaults(t||{},{fullscreen:!1,width:640,height:480,type:y.Types.svg,autostart:!1}),e.each(t,function(t,e){"fullscreen"===e||"width"===e||"height"===e||"autostart"===e||(this[e]=t)},this),e.isElement(t.domElement)){var i=t.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+i)||(this.type=y.Types[i])}this.renderer=new y[this.type](this),y.Utils.setPlaying.call(this,t.autostart),this.frameCount=0,t.fullscreen?(t=e.bind(r,this),e.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),e.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),_.bind(s,"resize",t),t()):e.isElement(t.domElement)||(this.renderer.setSize(t.width,t.height,this.ratio),this.width=t.width,this.height=t.height),this.scene=this.renderer.scene,y.Instances.push(this)};e.extend(y,{Array:s.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.6.0",Identifier:"two_",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){return s.Two=t,this},uniqueId:function(){var t=g;return g++,t},Utils:{defineProperty:function(t){var e="_"+t,i="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(this,t,{
get:function(){return this[e]},set:function(t){this[e]=t,this[i]=!0}})},release:function(t){e.isObject(t)&&(e.isFunction(t.unbind)&&t.unbind(),t.vertices&&(e.isFunction(t.vertices.unbind)&&t.vertices.unbind(),e.each(t.vertices,function(t){e.isFunction(t.unbind)&&t.unbind()})),t.children&&e.each(t.children,function(t){y.Utils.release(t)}))},xhr:function(t,e){var i=new XMLHttpRequest;return i.open("GET",t),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&e(i.responseText)},i.send(),i},Curve:{CollinearityEpsilon:d(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]},devicePixelRatio:s.devicePixelRatio||1,getBackingStoreRatio:function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},getRatio:function(t){return y.Utils.devicePixelRatio/k(t)},setPlaying:function(t){return this.playing=!!t,this},getComputedMatrix:function(t,i){i=i&&i.identity()||new y.Matrix;for(var n=t,r=[];n&&n._matrix;)r.push(n._matrix),n=n.parent;return r.reverse(),e.each(r,function(t){t=t.elements,i.multiply(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9])}),i},deltaTransformPoint:function(t,e,i){return new y.Vector(e*t.a+i*t.c+0,e*t.b+i*t.d+0)},decomposeMatrix:function(t){var e=y.Utils.deltaTransformPoint(t,0,1),i=y.Utils.deltaTransformPoint(t,1,0),e=180/Math.PI*Math.atan2(e.y,e.x)-90,i=180/Math.PI*Math.atan2(i.y,i.x);return{translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),skewX:e,skewY:i,rotation:e}},applySvgAttributes:function(t,i){var n,r,s,o={},a={};if(getComputedStyle){var l=getComputedStyle(t);for(n=l.length;n--;)r=l[n],s=l[r],void 0!==s&&(a[r]=s)}for(n=t.attributes.length;n--;)s=t.attributes[n],o[s.nodeName]=s.value;e.isUndefined(a.opacity)||(a["stroke-opacity"]=a.opacity,a["fill-opacity"]=a.opacity),e.extend(a,o),a.visible=!(e.isUndefined(a.display)&&"none"===a.display)||e.isUndefined(a.visibility)&&"hidden"===a.visibility;for(r in a)switch(s=a[r],r){case"transform":if("none"===s)break;if(null===t.getCTM())break;o=y.Utils.decomposeMatrix(t.getCTM()),i.translation.set(o.translateX,o.translateY),i.rotation=o.rotation,i.scale=o.scaleX,a.x&&(i.translation.x=a.x),a.y&&(i.translation.y=a.y);break;case"visible":i.visible=s;break;case"stroke-linecap":i.cap=s;break;case"stroke-linejoin":i.join=s;break;case"stroke-miterlimit":i.miter=s;break;case"stroke-width":i.linewidth=parseFloat(s);break;case"stroke-opacity":case"fill-opacity":case"opacity":i.opacity=parseFloat(s);break;case"fill":case"stroke":i[r]=/url\(\#.*\)/i.test(s)?this.getById(s.replace(/url\(\#(.*)\)/i,"$1")):"none"===s?"transparent":s;break;case"id":i.id=s;break;case"class":i.classList=s.split(" ")}return i},read:{svg:function(){return y.Utils.read.g.apply(this,arguments)},g:function(t){var e=new y.Group;y.Utils.applySvgAttributes.call(this,t,e);for(var i=0,n=t.childNodes.length;n>i;i++){var r=t.childNodes[i],s=r.nodeName;if(!s)return;s=s.replace(/svg\:/gi,"").toLowerCase(),s in y.Utils.read&&(r=y.Utils.read[s].call(e,r),e.add(r))}return e},polygon:function(t,e){var i=[];t.getAttribute("points").replace(/(-?[\d\.?]+),(-?[\d\.?]+)/g,function(t,e,n){i.push(new y.Anchor(parseFloat(e),parseFloat(n)))});var n=new y.Path(i,!e).noStroke();return n.fill="black",y.Utils.applySvgAttributes.call(this,t,n)},polyline:function(t){return y.Utils.read.polygon.call(this,t,!0)},path:function(t){var i,n,r=t.getAttribute("d"),s=new y.Anchor,o=!1,a=!1,l=r.match(/[a-df-z][^a-df-z]*/gi),c=l.length-1;return e.each(l.slice(0),function(t,e){var i,n=t[0],r=n.toLowerCase(),s=t.slice(1).trim().split(/[\s,]+|(?=\s?[+\-])/),o=[];switch(0>=e&&(l=[]),r){case"h":case"v":1<s.length&&(i=1);break;case"m":case"l":case"t":2<s.length&&(i=2);break;case"s":case"q":4<s.length&&(i=4);break;case"c":6<s.length&&(i=6)}if(i){for(var r=0,a=s.length,c=0;a>r;r+=i){var h=n;if(c>0)switch(n){case"m":h="l";break;case"M":h="L"}o.push([h].concat(s.slice(r,r+i)).join(" ")),c++}l=Array.prototype.concat.apply(l,o)}else l.push(t)}),r=e.flatten(e.map(l,function(t,r){var l,h,u;h=t[0];var f=h.toLowerCase();n=t.slice(1).trim(),n=n.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(t,e,i){return parseFloat(e)*d(10,i)}),n=n.split(/[\s,]+|(?=\s?[+\-])/),a=h===f;var p,m,g,_;switch(f){case"z":r>=c?o=!0:(h=s.x,u=s.y,l=new y.Anchor(h,u,void 0,void 0,void 0,void 0,y.Commands.close));break;case"m":case"l":h=parseFloat(n[0]),u=parseFloat(n[1]),l=new y.Anchor(h,u,void 0,void 0,void 0,void 0,"m"===f?y.Commands.move:y.Commands.line),a&&l.addSelf(s),s=l;break;case"h":case"v":u="h"===f?"x":"y",f="x"===u?"y":"x",l=new y.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,y.Commands.line),l[u]=parseFloat(n[0]),l[f]=s[f],a&&(l[u]+=s[u]),s=l;break;case"c":case"s":l=s.x,u=s.y,i||(i=new y.Vector),"c"===f?(p=parseFloat(n[0]),m=parseFloat(n[1]),g=parseFloat(n[2]),_=parseFloat(n[3]),f=parseFloat(n[4]),h=parseFloat(n[5])):(f=C(s,i,a),p=f.x,m=f.y,g=parseFloat(n[0]),_=parseFloat(n[1]),f=parseFloat(n[2]),h=parseFloat(n[3])),a&&(p+=l,m+=u,g+=l,_+=u,f+=l,h+=u),e.isObject(s.controls)||y.Anchor.AppendCurveProperties(s),s.controls.right.set(p-s.x,m-s.y),s=l=new y.Anchor(f,h,g-f,_-h,void 0,void 0,y.Commands.curve),i=l.controls.left;break;case"t":case"q":l=s.x,u=s.y,i||(i=new y.Vector),i.isZero()?(p=l,m=u):(p=i.x,u=i.y),"q"===f?(g=parseFloat(n[0]),_=parseFloat(n[1]),f=parseFloat(n[1]),h=parseFloat(n[2])):(f=C(s,i,a),g=f.x,_=f.y,f=parseFloat(n[0]),h=parseFloat(n[1])),a&&(p+=l,m+=u,g+=l,_+=u,f+=l,h+=u),e.isObject(s.controls)||y.Anchor.AppendCurveProperties(s),s.controls.right.set(p-s.x,m-s.y),s=l=new y.Anchor(f,h,g-f,_-h,void 0,void 0,y.Commands.curve),i=l.controls.left;break;case"a":l=s.x,u=s.y;var v=parseFloat(n[0]),b=parseFloat(n[1]);m=parseFloat(n[2])*Math.PI/180,p=parseFloat(n[3]),g=parseFloat(n[4]),f=parseFloat(n[5]),h=parseFloat(n[6]),a&&(f+=l,h+=u);var x=(f-l)/2,A=(h-u)/2;_=x*Math.cos(m)+A*Math.sin(m);var x=-x*Math.sin(m)+A*Math.cos(m),A=v*v,k=b*b,E=_*_,S=x*x,M=E/A+S/k;M>1&&(v*=Math.sqrt(M),b*=Math.sqrt(M)),k=Math.sqrt((A*k-A*S-k*E)/(A*S+k*E)),e.isNaN(k)?k=0:p!=g&&k>0&&(k*=-1),A=k*v*x/b,k=-k*b*_/v,l=A*Math.cos(m)-k*Math.sin(m)+(l+f)/2;var E=A*Math.sin(m)+k*Math.cos(m)+(u+h)/2,F=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))*Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)))};u=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(F(t,e))};var q=u([1,0],[(_-A)/v,(x-k)/b]),S=[(_-A)/v,(x-k)/b];_=[(-_-A)/v,(-x-k)/b];var P=u(S,_);-1>=F(S,_)&&(P=Math.PI),1<=F(S,_)&&(P=0),p&&(P=w(P,2*Math.PI)),g&&P>0&&(P-=2*Math.PI);var R=y.Resolution,O=(new y.Matrix).translate(l,E).rotate(m);l=e.map(e.range(R),function(t){var e=(1-t/(R-1))*P+q;return t=v*Math.cos(e),e=b*Math.sin(e),t=O.multiply(t,e,1),new y.Anchor(t.x,t.y,!1,!1,!1,!1,y.Commands.line)}),l.push(new y.Anchor(f,h,!1,!1,!1,!1,y.Commands.line)),s=l[l.length-1],i=s.controls.left}return l})),1>=r.length?void 0:(r=e.compact(r),r=new y.Path(r,o,void 0,!0).noStroke(),r.fill="black",y.Utils.applySvgAttributes.call(this,t,r))},circle:function(t){var i=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),r=parseFloat(t.getAttribute("r")),s=y.Resolution,l=e.map(e.range(s),function(t){var e=t/s*u;return t=r*a(e),e=r*o(e),new y.Anchor(t,e)}),l=new y.Path(l,!0,!0).noStroke();return l.translation.set(i,n),l.fill="black",y.Utils.applySvgAttributes.call(this,t,l)},ellipse:function(t){var i=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),r=parseFloat(t.getAttribute("rx")),s=parseFloat(t.getAttribute("ry")),l=y.Resolution,c=e.map(e.range(l),function(t){var e=t/l*u;return t=r*a(e),e=s*o(e),new y.Anchor(t,e)}),c=new y.Path(c,!0,!0).noStroke();return c.translation.set(i,n),c.fill="black",y.Utils.applySvgAttributes.call(this,t,c)},rect:function(t){var e=parseFloat(t.getAttribute("x"))||0,i=parseFloat(t.getAttribute("y"))||0,n=parseFloat(t.getAttribute("width")),r=parseFloat(t.getAttribute("height")),n=n/2,r=r/2,s=[new y.Anchor(n,r),new y.Anchor(-n,r),new y.Anchor(-n,-r),new y.Anchor(n,-r)],s=new y.Path(s,!0).noStroke();return s.translation.set(e+n,i+r),s.fill="black",y.Utils.applySvgAttributes.call(this,t,s)},line:function(t){var e=parseFloat(t.getAttribute("x1")),i=parseFloat(t.getAttribute("y1")),n=parseFloat(t.getAttribute("x2")),r=parseFloat(t.getAttribute("y2")),n=(n-e)/2,r=(r-i)/2,s=[new y.Anchor(-n,-r),new y.Anchor(n,r)],s=new y.Path(s).noFill();return s.translation.set(e+n,i+r),y.Utils.applySvgAttributes.call(this,t,s)},lineargradient:function(t){for(var i=parseFloat(t.getAttribute("x1")),n=parseFloat(t.getAttribute("y1")),r=parseFloat(t.getAttribute("x2")),s=parseFloat(t.getAttribute("y2")),o=(r+i)/2,a=(s+n)/2,l=[],c=0;c<t.children.length;c++){var h=t.children[c],u=parseFloat(h.getAttribute("offset")),f=h.getAttribute("stop-color"),d=h.getAttribute("stop-opacity"),h=h.getAttribute("style");if(e.isNull(f))var p=h.match(/stop\-color\:\s?([\#a-fA-F0-9]*)/),f=p&&1<p.length?p[1]:void 0;e.isNull(d)&&(d=(p=h.match(/stop\-opacity\:\s?([0-1\.\-]*)/))&&1<p.length?parseFloat(p[1]):1),l.push(new y.Gradient.Stop(u,f,d))}return i=new y.LinearGradient(i-o,n-a,r-o,s-a,l),y.Utils.applySvgAttributes.call(this,t,i)},radialgradient:function(t){var i=parseFloat(t.getAttribute("cx"))||0,n=parseFloat(t.getAttribute("cy"))||0,r=parseFloat(t.getAttribute("r")),s=parseFloat(t.getAttribute("fx")),o=parseFloat(t.getAttribute("fy"));e.isNaN(s)&&(s=i),e.isNaN(o)&&(o=n);for(var a=Math.abs(i+s)/2,l=Math.abs(n+o)/2,c=[],h=0;h<t.children.length;h++){var u=t.children[h],f=parseFloat(u.getAttribute("offset")),d=u.getAttribute("stop-color"),p=u.getAttribute("stop-opacity"),u=u.getAttribute("style");if(e.isNull(d))var m=u.match(/stop\-color\:\s?([\#a-fA-F0-9]*)/),d=m&&1<m.length?m[1]:void 0;e.isNull(p)&&(p=(m=u.match(/stop\-opacity\:\s?([0-1\.\-]*)/))&&1<m.length?parseFloat(m[1]):1),c.push(new y.Gradient.Stop(f,d,p))}return i=new y.RadialGradient(i-a,n-l,r,c,s-a,o-l),y.Utils.applySvgAttributes.call(this,t,i)}},subdivide:function(t,i,n,r,s,o,a,l,c){c=c||y.Utils.Curve.RecursionLimit;var h=c+1;return t===a&&i===l?[new y.Anchor(a,l)]:e.map(e.range(0,h),function(e){var c=e/h;return e=E(c,t,n,s,a),c=E(c,i,r,o,l),new y.Anchor(e,c)})},getPointOnCubicBezier:function(t,e,i,n,r){var s=1-t;return s*s*s*e+3*s*s*t*i+3*s*t*t*n+t*t*t*r},getCurveLength:function(t,e,i,n,r,s,o,a,l){if(t===i&&e===n&&r===o&&s===a)return t=o-t,e=a-e,c(t*t+e*e);var h=9*(i-r)+3*(o-t),u=6*(t+r)-12*i,f=3*(i-t),d=9*(n-s)+3*(a-e),p=6*(e+s)-12*n,m=3*(n-e);return S(function(t){var e=(h*t+u)*t+f;return t=(d*t+p)*t+m,c(e*e+t*t)},0,1,l||y.Utils.Curve.RecursionLimit)},integrate:function(t,e,i,n){var r=y.Utils.Curve.abscissas[n-2],s=y.Utils.Curve.weights[n-2];i=.5*(i-e),e=i+e;var o=0,a=n+1>>1;for(n=1&n?s[o++]*t(e):0;a>o;){var l=i*r[o];n+=s[o++]*(t(e+l)+t(e-l))}return i*n},getCurveFromPoints:function(t,i){for(var n=t.length,r=n-1,s=0;n>s;s++){var o=t[s];e.isObject(o.controls)||y.Anchor.AppendCurveProperties(o);var a=i?w(s-1,n):m(s-1,0),l=i?w(s+1,n):p(s+1,r);A(t[a],o,t[l]),o._command=0===s?y.Commands.move:y.Commands.curve,o.controls.left.x=e.isNumber(o.controls.left.x)?o.controls.left.x:o.x,o.controls.left.y=e.isNumber(o.controls.left.y)?o.controls.left.y:o.y,o.controls.right.x=e.isNumber(o.controls.right.x)?o.controls.right.x:o.x,o.controls.right.y=e.isNumber(o.controls.right.y)?o.controls.right.y:o.y}},getControlPoints:function(t,i,n){var r=x(t,i),s=x(n,i);t=v(t,i),n=v(n,i);var l=(r+s)/2;return i.u=e.isObject(i.controls.left)?i.controls.left:new y.Vector(0,0),i.v=e.isObject(i.controls.right)?i.controls.right:new y.Vector(0,0),1e-4>t||1e-4>n?(i._relative||(i.controls.left.copy(i),i.controls.right.copy(i)),i):(t*=.33,n*=.33,l=r>s?l+f:l-f,i.controls.left.x=a(l)*t,i.controls.left.y=o(l)*t,l-=h,i.controls.right.x=a(l)*n,i.controls.right.y=o(l)*n,i._relative||(i.controls.left.x+=i.x,i.controls.left.y+=i.y,i.controls.right.x+=i.x,i.controls.right.y+=i.y),i)},getReflection:function(t,e,i){return new y.Vector(2*t.x-(e.x+t.x)-(i?t.x:0),2*t.y-(e.y+t.y)-(i?t.y:0))},getAnchorsFromArcData:function(t,i,n,r,s,o,a){(new y.Matrix).translate(t.x,t.y).rotate(i);var l=y.Resolution;return e.map(e.range(l),function(t){t=(t+1)/l,a&&(t=1-t);var e=t*o+s;return t=n*Math.cos(e),e=r*Math.sin(e),t=new y.Anchor(t,e),y.Anchor.AppendCurveProperties(t),t.command=y.Commands.line,t})},ratioBetween:function(t,e){return(t.x*e.x+t.y*e.y)/(t.length()*e.length())},angleBetween:function(t,e){var i,n;return 4<=arguments.length?(i=arguments[0]-arguments[2],n=arguments[1]-arguments[3],l(n,i)):(i=t.x-e.x,n=t.y-e.y,l(n,i))},distanceBetweenSquared:function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},distanceBetween:function(t,e){return c(b(t,e))},toFixed:function(t){return Math.floor(1e3*t)/1e3},mod:function(t,e){for(;0>t;)t+=e;return t%e},Collection:function(){Array.call(this),1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(t){this.name="two.js",this.message=t}}}),y.Utils.Error.prototype=Error(),y.Utils.Error.prototype.constructor=y.Utils.Error,y.Utils.Collection.prototype=[],y.Utils.Collection.constructor=y.Utils.Collection,e.extend(y.Utils.Collection.prototype,i.Events,{pop:function(){var t=Array.prototype.pop.apply(this,arguments);return this.trigger(y.Events.remove,[t]),t},shift:function(){var t=Array.prototype.shift.apply(this,arguments);return this.trigger(y.Events.remove,[t]),t},push:function(){var t=Array.prototype.push.apply(this,arguments);return this.trigger(y.Events.insert,arguments),t},unshift:function(){var t=Array.prototype.unshift.apply(this,arguments);return this.trigger(y.Events.insert,arguments),t},splice:function(){var t,e=Array.prototype.splice.apply(this,arguments);return this.trigger(y.Events.remove,e),2<arguments.length&&(t=this.slice(arguments[0],arguments.length-2),this.trigger(y.Events.insert,t),this.trigger(y.Events.order)),e},sort:function(){return Array.prototype.sort.apply(this,arguments),this.trigger(y.Events.order),this},reverse:function(){return Array.prototype.reverse.apply(this,arguments),this.trigger(y.Events.order),this}});var v=y.Utils.distanceBetween,b=y.Utils.distanceBetweenSquared,x=y.Utils.angleBetween,A=y.Utils.getControlPoints,w=y.Utils.mod,k=y.Utils.getBackingStoreRatio,E=y.Utils.getPointOnCubicBezier,S=y.Utils.integrate,C=y.Utils.getReflection;e.extend(y.prototype,i.Events,{appendTo:function(t){return t.appendChild(this.renderer.domElement),this},play:function(){return y.Utils.setPlaying.call(this,!0),this.trigger(y.Events.play)},pause:function(){return this.playing=!1,this.trigger(y.Events.pause)},update:function(){var t=!!this._lastFrame,e=(s.performance&&s.performance.now?s.performance:Date).now();this.frameCount++,t&&(this.timeDelta=parseFloat((e-this._lastFrame).toFixed(3))),this._lastFrame=e;var t=this.width,e=this.height,i=this.renderer;return(t!==i.width||e!==i.height)&&i.setSize(t,e,this.ratio),this.trigger(y.Events.update,this.frameCount,this.timeDelta),this.render()},render:function(){return this.renderer.render(),this.trigger(y.Events.render,this.frameCount)},add:function(t){var i=t;return i instanceof Array||(i=e.toArray(arguments)),this.scene.add(i),this},remove:function(t){var i=t;return i instanceof Array||(i=e.toArray(arguments)),this.scene.remove(i),this},clear:function(){return this.scene.remove(e.toArray(this.scene.children)),this},makeLine:function(t,e,i,n){return t=new y.Line(t,e,i,n),this.scene.add(t),t},makeRectangle:function(t,e,i,n){return t=new y.Rectangle(t,e,i,n),this.scene.add(t),t},makeRoundedRectangle:function(t,e,i,n,r){return t=new y.RoundedRectangle(t,e,i,n,r),this.scene.add(t),t},makeCircle:function(t,e,i){return this.makeEllipse(t,e,i,i)},makeEllipse:function(t,e,i,n){return t=new y.Ellipse(t,e,i,n),this.scene.add(t),t},makeStar:function(t,e,i,n,r){return t=new y.Star(t,e,i,n,r),this.scene.add(t),t},makeCurve:function(t){var i=arguments.length,n=t;if(!e.isArray(t))for(var n=[],r=0;i>r;r+=2){var s=arguments[r];if(!e.isNumber(s))break;n.push(new y.Anchor(s,arguments[r+1]))}return i=arguments[i-1],n=new y.Path(n,!(e.isBoolean(i)&&i),!0),i=n.getBoundingClientRect(),n.center().translation.set(i.left+i.width/2,i.top+i.height/2),this.scene.add(n),n},makePolygon:function(t,e,i,n){return t=new y.Polygon(t,e,i,n),this.scene.add(t),t},makeArcSegment:function(t,e,i,n,r,s,o){return t=new y.ArcSegment(t,e,i,n,r,s,o),this.scene.add(t),t},makePath:function(t){var i=arguments.length,n=t;if(!e.isArray(t))for(var n=[],r=0;i>r;r+=2){var s=arguments[r];if(!e.isNumber(s))break;n.push(new y.Anchor(s,arguments[r+1]))}return i=arguments[i-1],n=new y.Path(n,!(e.isBoolean(i)&&i)),i=n.getBoundingClientRect(),n.center().translation.set(i.left+i.width/2,i.top+i.height/2),this.scene.add(n),n},makeText:function(t,e,i,n){return t=new y.Text(t,e,i,n),this.add(t),t},makeLinearGradient:function(t,e,i,n){var r=Array.prototype.slice.call(arguments,4),r=new y.LinearGradient(t,e,i,n,r);return this.add(r),r},makeRadialGradient:function(t,e,i){var n=Array.prototype.slice.call(arguments,3),n=new y.RadialGradient(t,e,i,n);return this.add(n),n},makeGroup:function(t){var i=t;i instanceof Array||(i=e.toArray(arguments));var n=new y.Group;return this.scene.add(n),n.add(i),n},interpret:function(t,e){var i=t.tagName.toLowerCase();return i in y.Utils.read?(i=y.Utils.read[i].call(this,t),e&&i instanceof y.Group?this.add(i.children):this.add(i),i):null},load:function(t,i){var n,r,s=[];if(/.*\.svg/gi.test(t))return y.Utils.xhr(t,e.bind(function(t){for(_.temp.innerHTML=t,r=0;r<_.temp.children.length;r++)n=_.temp.children[r],s.push(this.interpret(n));i(1>=s.length?s[0]:s,1>=_.temp.children.length?_.temp.children[0]:_.temp.children)},this)),this;for(_.temp.innerHTML=t,r=0;r<_.temp.children.length;r++)n=_.temp.children[r],s.push(this.interpret(n));return i(1>=s.length?s[0]:s,1>=_.temp.children.length?_.temp.children[0]:_.temp.children),this}}),function(){n(arguments.callee),y.Instances.forEach(function(t){t.playing&&t.update()})}(),"function"==typeof define&&define.amd?define(function(){return y}):"undefined"!=typeof module&&module.exports&&(module.exports=y)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i){var n=t.Vector=function(t,e){this.x=t||0,this.y=e||0};e.extend(n,{zero:new t.Vector}),e.extend(n.prototype,i.Events,{set:function(t,e){return this.x=t,this.y=e,this},copy:function(t){return this.x=t.x,this.y=t.y,this},clear:function(){return this.y=this.x=0,this},clone:function(){return new n(this.x,this.y)},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this},multiplySelf:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return t?(this.x/=t,this.y/=t):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t,e){return this.distanceTo(t)<("undefined"==typeof e?1e-4:e)},lerp:function(t,e){return this.set((t.x-this.x)*e+this.x,(t.y-this.y)*e+this.y)},isZero:function(t){return this.length()<("undefined"==typeof t?1e-4:t)},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var r={set:function(e,i){return this._x=e,this._y=i,this.trigger(t.Events.change)},copy:function(e){return this._x=e.x,this._y=e.y,this.trigger(t.Events.change)},clear:function(){return this._y=this._x=0,this.trigger(t.Events.change)},clone:function(){return new n(this._x,this._y)},add:function(e,i){return this._x=e.x+i.x,this._y=e.y+i.y,this.trigger(t.Events.change)},addSelf:function(e){return this._x+=e.x,this._y+=e.y,this.trigger(t.Events.change)},sub:function(e,i){return this._x=e.x-i.x,this._y=e.y-i.y,this.trigger(t.Events.change)},subSelf:function(e){return this._x-=e.x,this._y-=e.y,this.trigger(t.Events.change)},multiplySelf:function(e){return this._x*=e.x,this._y*=e.y,this.trigger(t.Events.change)},multiplyScalar:function(e){return this._x*=e,this._y*=e,this.trigger(t.Events.change)},divideScalar:function(e){return e?(this._x/=e,this._y/=e,this.trigger(t.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this._x*t.x+this._y*t.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this._x-t.x;return t=this._y-t.y,e*e+t*t},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t,e){return this.distanceTo(t)<("undefined"==typeof e?1e-4:e)},lerp:function(t,e){return this.set((t.x-this._x)*e+this._x,(t.y-this._y)*e+this._y)},isZero:function(t){return this.length()<("undefined"==typeof t?1e-4:t)},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},s={get:function(){return this._x},set:function(e){this._x=e,this.trigger(t.Events.change,"x")}},o={get:function(){return this._y},set:function(e){this._y=e,this.trigger(t.Events.change,"y")}};t.Vector.prototype.bind=t.Vector.prototype.on=function(){return this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",s),Object.defineProperty(this,"y",o),e.extend(this,r),this._bound=!0),i.Events.bind.apply(this,arguments),this}}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Commands,n=t.Anchor=function(r,s,o,a,l,c,h){return t.Vector.call(this,r,s),this._broadcast=e.bind(function(){this.trigger(t.Events.change)},this),this._command=h||i.move,this._relative=!0,h?(n.AppendCurveProperties(this),e.isNumber(o)&&(this.controls.left.x=o),e.isNumber(a)&&(this.controls.left.y=a),e.isNumber(l)&&(this.controls.right.x=l),void(e.isNumber(c)&&(this.controls.right.y=c))):this};e.extend(n,{AppendCurveProperties:function(e){e.controls={left:new t.Vector(0,0),right:new t.Vector(0,0)}}});var r={listen:function(){return e.isObject(this.controls)||n.AppendCurveProperties(this),this.controls.left.bind(t.Events.change,this._broadcast),this.controls.right.bind(t.Events.change,this._broadcast),this},ignore:function(){return this.controls.left.unbind(t.Events.change,this._broadcast),this.controls.right.unbind(t.Events.change,this._broadcast),this},clone:function(){var e=this.controls,e=new t.Anchor(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command);return e.relative=this._relative,e},toObject:function(){var t={x:this.x,y:this.y};return this._command&&(t.command=this._command),this._relative&&(t.relative=this._relative),this.controls&&(t.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()}),t}};Object.defineProperty(n.prototype,"command",{get:function(){return this._command},set:function(r){return this._command=r,this._command===i.curve&&!e.isObject(this.controls)&&n.AppendCurveProperties(this),this.trigger(t.Events.change)}}),Object.defineProperty(n.prototype,"relative",{get:function(){return this._relative},set:function(e){return this._relative==e?this:(this._relative=!!e,this.trigger(t.Events.change))}}),e.extend(n.prototype,t.Vector.prototype,r),t.Anchor.prototype.bind=t.Anchor.prototype.on=function(){t.Vector.prototype.bind.apply(this,arguments),e.extend(this,r)},t.Anchor.prototype.unbind=t.Anchor.prototype.off=function(){t.Vector.prototype.unbind.apply(this,arguments),e.extend(this,r)}}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i){var n=Math.cos,r=Math.sin,s=Math.tan,o=t.Matrix=function(i,n,r,s,o,a){this.elements=new t.Array(9);var l=i;e.isArray(l)||(l=e.toArray(arguments)),this.identity().set(l)};e.extend(o,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(e,i,n){if(3>=i.length){n=i[0]||0;var r=i[1]||0;return i=i[2]||0,{x:e[0]*n+e[1]*r+e[2]*i,y:e[3]*n+e[4]*r+e[5]*i,z:e[6]*n+e[7]*r+e[8]*i}}var r=e[0],s=e[1],o=e[2],a=e[3],l=e[4],c=e[5],h=e[6],u=e[7];e=e[8];var f=i[0],d=i[1],p=i[2],m=i[3],g=i[4],_=i[5],y=i[6],v=i[7];return i=i[8],n=n||new t.Array(9),n[0]=r*f+s*m+o*y,n[1]=r*d+s*g+o*v,n[2]=r*p+s*_+o*i,n[3]=a*f+l*m+c*y,n[4]=a*d+l*g+c*v,n[5]=a*p+l*_+c*i,n[6]=h*f+u*m+e*y,n[7]=h*d+u*g+e*v,n[8]=h*p+u*_+e*i,n}}),e.extend(o.prototype,i.Events,{set:function(i){var n=i;return e.isArray(n)||(n=e.toArray(arguments)),e.extend(this.elements,n),this.trigger(t.Events.change)},identity:function(){return this.set(o.Identity),this},multiply:function(i,n,r,s,o,a,l,c,h){var u=arguments,f=u.length;if(1>=f)return e.each(this.elements,function(t,e){this.elements[e]=t*i},this),this.trigger(t.Events.change);if(3>=f)return i=i||0,n=n||0,r=r||0,o=this.elements,{x:o[0]*i+o[1]*n+o[2]*r,y:o[3]*i+o[4]*n+o[5]*r,z:o[6]*i+o[7]*n+o[8]*r};var d=this.elements,p=u,u=d[0],f=d[1],m=d[2],g=d[3],_=d[4],y=d[5],v=d[6],b=d[7],d=d[8],x=p[0],A=p[1],w=p[2],k=p[3],E=p[4],S=p[5],C=p[6],M=p[7],p=p[8];return this.elements[0]=u*x+f*k+m*C,this.elements[1]=u*A+f*E+m*M,this.elements[2]=u*w+f*S+m*p,this.elements[3]=g*x+_*k+y*C,this.elements[4]=g*A+_*E+y*M,this.elements[5]=g*w+_*S+y*p,this.elements[6]=v*x+b*k+d*C,this.elements[7]=v*A+b*E+d*M,this.elements[8]=v*w+b*S+d*p,this.trigger(t.Events.change)},inverse:function(e){var i=this.elements;e=e||new t.Matrix;var n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],l=i[5],c=i[6],h=i[7],i=i[8],u=i*a-l*h,f=-i*o+l*c,d=h*o-a*c,p=n*u+r*f+s*d;return p?(p=1/p,e.elements[0]=u*p,e.elements[1]=(-i*r+s*h)*p,e.elements[2]=(l*r-s*a)*p,e.elements[3]=f*p,e.elements[4]=(i*n-s*c)*p,e.elements[5]=(-l*n+s*o)*p,e.elements[6]=d*p,e.elements[7]=(-h*n+r*c)*p,e.elements[8]=(a*n-r*o)*p,e):null},scale:function(t,e){return 1>=arguments.length&&(e=t),this.multiply(t,0,0,0,e,0,0,0,1)},rotate:function(t){var e=n(t);return t=r(t),this.multiply(e,-t,0,t,e,0,0,0,1)},translate:function(t,e){return this.multiply(1,0,t,0,1,e,0,0,1)},skewX:function(t){return t=s(t),this.multiply(1,t,0,0,1,0,0,0,1)},skewY:function(t){return t=s(t),this.multiply(1,0,0,t,1,0,0,0,1)},toString:function(t){var e=[];return this.toArray(t,e),e.join(" ")},toArray:function(t,e){var i=this.elements,n=!!e,r=parseFloat(i[0].toFixed(3)),s=parseFloat(i[1].toFixed(3)),o=parseFloat(i[2].toFixed(3)),a=parseFloat(i[3].toFixed(3)),l=parseFloat(i[4].toFixed(3)),c=parseFloat(i[5].toFixed(3));if(t){var h=parseFloat(i[6].toFixed(3)),u=parseFloat(i[7].toFixed(3)),i=parseFloat(i[8].toFixed(3));return n?(e[0]=r,e[1]=a,e[2]=h,e[3]=s,e[4]=l,e[5]=u,e[6]=o,e[7]=c,void(e[8]=i)):[r,a,h,s,l,u,o,c,i]}return n?(e[0]=r,e[1]=a,e[2]=s,e[3]=l,e[4]=o,e[5]=c,void 0):[r,a,s,l,o,c]},clone:function(){return new t.Matrix(this.elements[0],this.elements[1],this.elements[2],this.elements[3],this.elements[4],this.elements[5],this.elements[6],this.elements[7],this.elements[8])}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i){var n=t.Utils.mod,r=t.Utils.toFixed,s={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},createElement:function(t,i){var n=document.createElementNS(this.ns,t);return"svg"===t&&(i=e.defaults(i||{},{version:this.version})),e.isEmpty(i)||s.setAttributes(n,i),n},setAttributes:function(t,e){for(var i=Object.keys(e),n=0;n<i.length;n++)t.setAttribute(i[n],e[i[n]]);return this},removeAttributes:function(t,e){for(var i in e)t.removeAttribute(i);return this},toString:function(e,i){for(var s,o=e.length,a=o-1,l="",c=0;o>c;c++){var h,u=e[c],f=i?n(c-1,o):Math.max(c-1,0),d=i?n(c+1,o):Math.min(c+1,a);h=e[f];var p,m,g,_=e[d],f=r(u._x),_=r(u._y);switch(u._command){case t.Commands.close:h=t.Commands.close;break;case t.Commands.curve:p=h.controls&&h.controls.right||h,g=u.controls&&u.controls.left||u,h._relative?(d=r(p.x+h.x),p=r(p.y+h.y)):(d=r(p.x),p=r(p.y)),u._relative?(m=r(g.x+u.x),g=r(g.y+u.y)):(m=r(g.x),g=r(g.y)),
h=(0===c?t.Commands.move:t.Commands.curve)+" "+d+" "+p+" "+m+" "+g+" "+f+" "+_;break;case t.Commands.move:s=u,h=t.Commands.move+" "+f+" "+_;break;default:h=u._command+" "+f+" "+_}c>=a&&i&&(u._command===t.Commands.curve&&(_=s,p=u.controls&&u.controls.right||u,f=_.controls&&_.controls.left||_,u._relative?(d=r(p.x+u.x),p=r(p.y+u.y)):(d=r(p.x),p=r(p.y)),_._relative?(m=r(f.x+_.x),g=r(f.y+_.y)):(m=r(f.x),g=r(f.y)),f=r(_.x),_=r(_.y),h+=" C "+d+" "+p+" "+m+" "+g+" "+f+" "+_),h+=" Z"),l+=h+" "}return l},getClip:function(t){var e=t._renderer.clip;if(!e){for(var i=t;i.parent;)i=i.parent;e=t._renderer.clip=s.createElement("clipPath"),i.defs.appendChild(e)}return e},group:{appendChild:function(t){var e=t._renderer.elem;if(e){var i=e.nodeName;i&&!/(radial|linear)gradient/i.test(i)&&!t._clip&&this.elem.appendChild(e)}},removeChild:function(t){var e=t._renderer.elem;e&&e.parentNode==this.elem&&e.nodeName&&(t._clip||this.elem.removeChild(e))},orderChild:function(t){this.elem.appendChild(t._renderer.elem)},renderChild:function(t){s[t._renderer.type].render.call(t,this)},render:function(t){if(this._update(),0===this._opacity&&!this._flagOpacity)return this;this._renderer.elem||(this._renderer.elem=s.createElement("g",{id:this.id}),t.appendChild(this._renderer.elem));var e={domElement:t,elem:this._renderer.elem};(this._matrix.manual||this._flagMatrix)&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(var i=0;i<this.children.length;i++){var n=this.children[i];s[n._renderer.type].render.call(n,t)}return this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagAdditions&&this.additions.forEach(s.group.appendChild,e),this._flagSubtractions&&this.subtractions.forEach(s.group.removeChild,e),this._flagOrder&&this.children.forEach(s.group.orderChild,e),this._flagMask&&(this._mask?this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")"):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},path:{render:function(t){if(this._update(),0===this._opacity&&!this._flagOpacity)return this;var e={};if((this._matrix.manual||this._flagMatrix)&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagVertices){var i=s.toString(this._vertices,this._closed);e.d=i}return this._flagFill&&(this._fill&&this._fill._renderer&&s[this._fill._renderer.type].render.call(this._fill,t),e.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._flagStroke&&(this._stroke&&this._stroke._renderer&&s[this._stroke._renderer.type].render.call(this._stroke,t),e.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e["stroke-opacity"]=this._opacity,e["fill-opacity"]=this._opacity),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this._flagCap&&(e["stroke-linecap"]=this._cap),this._flagJoin&&(e["stroke-linejoin"]=this._join),this._flagMiter&&(e["stroke-miterlimit"]=this._miter),this._renderer.elem?s.setAttributes(this._renderer.elem,e):(e.id=this.id,this._renderer.elem=s.createElement("path",e),t.appendChild(this._renderer.elem)),this._flagClip&&(t=s.getClip(this),e=this._renderer.elem,this._clip?(e.removeAttribute("id"),t.setAttribute("id",this.id),t.appendChild(e)):(t.removeAttribute("id"),e.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(e))),this.flagReset()}},text:{render:function(t){this._update();var e={};return(this._matrix.manual||this._flagMatrix)&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagFamily&&(e["font-family"]=this._family),this._flagSize&&(e["font-size"]=this._size),this._flagLeading&&(e["line-height"]=this._leading),this._flagAlignment&&(e["text-anchor"]=s.alignments[this._alignment]||this._alignment),this._flagBaseline&&(e["alignment-baseline"]=e["dominant-baseline"]=this._baseline),this._flagStyle&&(e["font-style"]=this._style),this._flagWeight&&(e["font-weight"]=this._weight),this._flagDecoration&&(e["text-decoration"]=this._decoration),this._flagFill&&(e.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._flagStroke&&(e.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e.opacity=this._opacity),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this._renderer.elem?s.setAttributes(this._renderer.elem,e):(e.id=this.id,this._renderer.elem=s.createElement("text",e),t.defs.appendChild(this._renderer.elem)),this._flagClip&&(t=s.getClip(this),e=this._renderer.elem,this._clip?(e.removeAttribute("id"),t.setAttribute("id",this.id),t.appendChild(e)):(t.removeAttribute("id"),e.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(e))),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(t){this._update();var e={};if(this._flagEndPoints&&(e.x1=this.left._x,e.y1=this.left._y,e.x2=this.right._x,e.y2=this.right._y),this._flagSpread&&(e.spreadMethod=this._spread),this._renderer.elem?s.setAttributes(this._renderer.elem,e):(e.id=this.id,e.gradientUnits="userSpaceOnUse",this._renderer.elem=s.createElement("linearGradient",e),t.defs.appendChild(this._renderer.elem)),this._flagStops)for(t=this._renderer.elem.childNodes.length=0;t<this.stops.length;t++){var e=this.stops[t],i={};e._flagOffset&&(i.offset=100*e._offset+"%"),e._flagColor&&(i["stop-color"]=e._color),e._flagOpacity&&(i["stop-opacity"]=e._opacity),e._renderer.elem?s.setAttributes(e._renderer.elem,i):e._renderer.elem=s.createElement("stop",i),this._renderer.elem.appendChild(e._renderer.elem),e.flagReset()}return this.flagReset()}},"radial-gradient":{render:function(t){this._update();var e={};if(this._flagCenter&&(e.cx=this.center._x,e.cy=this.center._y),this._flagFocal&&(e.fx=this.focal._x,e.fy=this.focal._y),this._flagRadius&&(e.r=this._radius),this._flagSpread&&(e.spreadMethod=this._spread),this._renderer.elem?s.setAttributes(this._renderer.elem,e):(e.id=this.id,e.gradientUnits="userSpaceOnUse",this._renderer.elem=s.createElement("radialGradient",e),t.defs.appendChild(this._renderer.elem)),this._flagStops)for(t=this._renderer.elem.childNodes.length=0;t<this.stops.length;t++){var e=this.stops[t],i={};e._flagOffset&&(i.offset=100*e._offset+"%"),e._flagColor&&(i["stop-color"]=e._color),e._flagOpacity&&(i["stop-opacity"]=e._opacity),e._renderer.elem?s.setAttributes(e._renderer.elem,i):e._renderer.elem=s.createElement("stop",i),this._renderer.elem.appendChild(e._renderer.elem),e.flagReset()}return this.flagReset()}}},o=t[t.Types.svg]=function(e){this.domElement=e.domElement||s.createElement("svg"),this.scene=new t.Group,this.scene.parent=this,this.defs=s.createElement("defs"),this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"};e.extend(o,{Utils:s}),e.extend(o.prototype,i.Events,{setSize:function(t,e){return this.width=t,this.height=e,s.setAttributes(this.domElement,{width:t,height:e}),this},render:function(){return s.group.render.call(this.scene,this.domElement),this}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i){var n=t.Utils.mod,r=t.Utils.toFixed,s=t.Utils.getRatio,o=function(t){return 1==t[0]&&0==t[3]&&0==t[1]&&1==t[4]&&0==t[2]&&0==t[5]},a={isHidden:/(none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},group:{renderChild:function(t){a[t._renderer.type].render.call(t,this.ctx,!0,this.clip)},render:function(t){this._update();var e=this._matrix.elements,i=this.parent;this._renderer.opacity=this._opacity*(i&&i._renderer?i._renderer.opacity:1);var i=o(e),n=this._mask;for(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=t,i||(t.save(),t.transform(e[0],e[3],e[1],e[4],e[2],e[5])),n&&a[n._renderer.type].render.call(n,t,!0),e=0;e<this.children.length;e++)n=this.children[e],a[n._renderer.type].render.call(n,t);return i||t.restore(),this.flagReset()}},path:{render:function(i,s,l){var c,h,u,f,d,p,m,g,_,y,v,b,x,A,w,k;if(this._update(),c=this._matrix.elements,h=this._stroke,u=this._linewidth,f=this._fill,d=this._opacity*this.parent._renderer.opacity,p=this._visible,m=this._cap,g=this._join,_=this._miter,y=this._closed,v=this._vertices,b=v.length,x=b-1,k=o(c),w=this._clip,!s&&(!p||w))return this;for(k||(i.save(),i.transform(c[0],c[3],c[1],c[4],c[2],c[5])),f&&(e.isString(f)?i.fillStyle=f:(a[f._renderer.type].render.call(f,i),i.fillStyle=f._renderer.gradient)),h&&(e.isString(h)?i.strokeStyle=h:(a[h._renderer.type].render.call(h,i),i.strokeStyle=h._renderer.gradient)),u&&(i.lineWidth=u),_&&(i.miterLimit=_),g&&(i.lineJoin=g),m&&(i.lineCap=m),e.isNumber(d)&&(i.globalAlpha=d),i.beginPath(),c=0;c<v.length;c++)switch(s=v[c],d=r(s._x),p=r(s._y),s._command){case t.Commands.close:i.closePath();break;case t.Commands.curve:u=y?n(c-1,b):Math.max(c-1,0),y?n(c+1,b):Math.min(c+1,x),m=v[u],g=m.controls&&m.controls.right||m,_=s.controls&&s.controls.left||s,m._relative?(u=g.x+r(m._x),g=g.y+r(m._y)):(u=r(g.x),g=r(g.y)),s._relative?(m=_.x+r(s._x),_=_.y+r(s._y)):(m=r(_.x),_=r(_.y)),i.bezierCurveTo(u,g,m,_,d,p),c>=x&&y&&(p=A,m=s.controls&&s.controls.right||s,d=p.controls&&p.controls.left||p,s._relative?(u=m.x+r(s._x),g=m.y+r(s._y)):(u=r(m.x),g=r(m.y)),p._relative?(m=d.x+r(p._x),_=d.y+r(p._y)):(m=r(d.x),_=r(d.y)),d=r(p._x),p=r(p._y),i.bezierCurveTo(u,g,m,_,d,p));break;case t.Commands.line:i.lineTo(d,p);break;case t.Commands.move:A=s,i.moveTo(d,p)}return y&&i.closePath(),!w&&!l&&(a.isHidden.test(f)||i.fill(),a.isHidden.test(h)||i.stroke()),k||i.restore(),w&&!l&&i.clip(),this.flagReset()}},"linear-gradient":{render:function(t){if(this._update(),!this._renderer.gradient||this._flagEndPoints||this._flagStops)for(this._renderer.gradient=t.createLinearGradient(this.left._x,this.left._y,this.right._x,this.right._y),t=0;t<this.stops.length;t++){var e=this.stops[t];this._renderer.gradient.addColorStop(e._offset,e._color)}return this.flagReset()}},text:{render:function(t,i,n){this._update();var r=this._matrix.elements,s=this._stroke,l=this._linewidth,c=this._fill,h=this._opacity*this.parent._renderer.opacity,u=this._visible,f=o(r),d=this._clip;return i||u&&!d?(f||(t.save(),t.transform(r[0],r[3],r[1],r[4],r[2],r[5])),t.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" "),t.textAlign=a.alignments[this._alignment]||this._alignment,t.textBaseline=this._baseline,c&&(e.isString(c)?t.fillStyle=c:(a[c._renderer.type].render.call(c,t),t.fillStyle=c._renderer.gradient)),s&&(e.isString(s)?t.strokeStyle=s:(a[s._renderer.type].render.call(s,t),t.strokeStyle=s._renderer.gradient)),l&&(t.lineWidth=l),e.isNumber(h)&&(t.globalAlpha=h),!d&&!n&&(a.isHidden.test(c)||t.fillText(this.value,0,0),a.isHidden.test(s)||t.strokeText(this.value,0,0)),f||t.restore(),d&&!n&&t.clip(),this.flagReset()):this}},"radial-gradient":{render:function(t){if(this._update(),!this._renderer.gradient||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops)for(this._renderer.gradient=t.createRadialGradient(this.center._x,this.center._y,0,this.focal._x,this.focal._y,this._radius),t=0;t<this.stops.length;t++){var e=this.stops[t];this._renderer.gradient.addColorStop(e._offset,e._color)}return this.flagReset()}}},l=t[t.Types.canvas]=function(e){var i=!1!==e.smoothing;this.domElement=e.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=e.overdraw||!1,this.ctx.imageSmoothingEnabled=i,this.ctx.mozImageSmoothingEnabled=i,this.ctx.oImageSmoothingEnabled=i,this.ctx.webkitImageSmoothingEnabled=i,this.ctx.imageSmoothingEnabled=i,this.scene=new t.Group,this.scene.parent=this};e.extend(l,{Utils:a}),e.extend(l.prototype,i.Events,{setSize:function(t,i,n){return this.width=t,this.height=i,this.ratio=e.isUndefined(n)?s(this.ctx):n,this.domElement.width=t*this.ratio,this.domElement.height=i*this.ratio,e.extend(this.domElement.style,{width:t+"px",height:i+"px"}),this},render:function(){var t=1===this.ratio;return t||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),a.group.render.call(this.scene,this.ctx),t||this.ctx.restore(),this}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i){var n=t.Matrix.Multiply,r=t.Utils.mod,s=[1,0,0,0,1,0,0,0,1],o=new t.Array(9),a=t.Utils.getRatio,l=t.Utils.toFixed,c={isHidden:/(none|transparent)/i,canvas:document.createElement("canvas"),alignments:{left:"start",middle:"center",right:"end"},matrix:new t.Matrix,uv:new t.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{removeChild:function(t,e){if(t.children)for(var i=0;i<t.children.length;i++)c.group.removeChild(t.children[i],e);else e.deleteTexture(t._renderer.texture),delete t._renderer.texture},renderChild:function(t){c[t._renderer.type].render.call(t,this.gl,this.program)},render:function(e,i){this._update();var r=this.parent,s=r._matrix&&r._matrix.manual||r._flagMatrix,a=this._matrix.manual||this._flagMatrix;if((s||a)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,o),n(o,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale,s&&(this._flagMatrix=!0)),this._mask&&(e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,1),e.colorMask(!1,!1,!1,!0),e.stencilOp(e.KEEP,e.KEEP,e.INCR),c[this._mask._renderer.type].render.call(this._mask,e,i,this),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.NOTEQUAL,0,1),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)),this._flagOpacity=r._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1),this._flagSubtractions)for(r=0;r<this.subtractions.length;r++)c.group.removeChild(this.subtractions[r],e);return this.children.forEach(c.group.renderChild,{gl:e,program:i}),this._mask&&(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),c[this._mask._renderer.type].render.call(this._mask,e,i,this),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.NOTEQUAL,0,1),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.disable(e.STENCIL_TEST)),this.flagReset()}},path:{updateCanvas:function(i){var n,s,o,a,h,u,f=i._vertices;n=this.canvas;var d=this.ctx;u=i._renderer.scale;var p=i._stroke;o=i._linewidth;var m=i._fill;s=i._renderer.opacity||i._opacity,h=i._cap,a=i._join;var g=i._miter,_=i._closed,y=f.length,v=y-1;n.width=Math.max(Math.ceil(i._renderer.rect.width*u),1),n.height=Math.max(Math.ceil(i._renderer.rect.height*u),1);var x=i._renderer.rect.centroid,A=x.x,x=x.y;d.clearRect(0,0,n.width,n.height),m&&(e.isString(m)?d.fillStyle=m:(c[m._renderer.type].render.call(m,d,i),d.fillStyle=m._renderer.gradient)),p&&(e.isString(p)?d.strokeStyle=p:(c[p._renderer.type].render.call(p,d,i),d.strokeStyle=p._renderer.gradient)),o&&(d.lineWidth=o),g&&(d.miterLimit=g),a&&(d.lineJoin=a),h&&(d.lineCap=h),e.isNumber(s)&&(d.globalAlpha=s);var w;for(d.save(),d.scale(u,u),d.translate(A,x),d.beginPath(),i=0;i<f.length;i++)switch(b=f[i],u=l(b._x),o=l(b._y),b._command){case t.Commands.close:d.closePath();break;case t.Commands.curve:n=_?r(i-1,y):Math.max(i-1,0),_?r(i+1,y):Math.min(i+1,v),s=f[n],h=s.controls&&s.controls.right||s,a=b.controls&&b.controls.left||b,s._relative?(n=l(h.x+s._x),h=l(h.y+s._y)):(n=l(h.x),h=l(h.y)),b._relative?(s=l(a.x+b._x),a=l(a.y+b._y)):(s=l(a.x),a=l(a.y)),d.bezierCurveTo(n,h,s,a,u,o),i>=v&&_&&(o=w,s=b.controls&&b.controls.right||b,u=o.controls&&o.controls.left||o,b._relative?(n=l(s.x+b._x),h=l(s.y+b._y)):(n=l(s.x),h=l(s.y)),o._relative?(s=l(u.x+o._x),a=l(u.y+o._y)):(s=l(u.x),a=l(u.y)),u=l(o._x),o=l(o._y),d.bezierCurveTo(n,h,s,a,u,o));break;case t.Commands.line:d.lineTo(u,o);break;case t.Commands.move:w=b,d.moveTo(u,o)}_&&d.closePath(),c.isHidden.test(m)||d.fill(),c.isHidden.test(p)||d.stroke(),d.restore()},getBoundingClientRect:function(t,i,n){var r=1/0,s=-(1/0),o=1/0,a=-(1/0);t.forEach(function(t){var e,i,n=t.x,l=t.y,c=t.controls;o=Math.min(l,o),r=Math.min(n,r),s=Math.max(n,s),a=Math.max(l,a),t.controls&&(e=c.left,i=c.right,e&&i&&(c=t._relative?e.x+n:e.x,e=t._relative?e.y+l:e.y,n=t._relative?i.x+n:i.x,t=t._relative?i.y+l:i.y,c&&e&&n&&t&&(o=Math.min(e,t,o),r=Math.min(c,n,r),s=Math.max(c,n,s),a=Math.max(e,t,a))))}),e.isNumber(i)&&(o-=i,r-=i,s+=i,a+=i),n.top=o,n.left=r,n.right=s,n.bottom=a,n.width=s-r,n.height=a-o,n.centroid||(n.centroid={}),n.centroid.x=-r,n.centroid.y=-o},render:function(e,i,r){if(!this._visible||!this._opacity)return this;var s=this.parent,a=s._matrix.manual||s._flagMatrix,l=this._matrix.manual||this._flagMatrix,h=this._flagVertices||this._flagFill||this._fill instanceof t.LinearGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof t.RadialGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._stroke instanceof t.LinearGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof t.RadialGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._flagStroke||this._flagLinewidth||this._flagOpacity||s._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||!this._renderer.texture;return this._update(),(a||l)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,o),n(o,s._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*s._renderer.scale),h&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new t.Array(12)),this._renderer.opacity=this._opacity*s._renderer.opacity,c.path.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),c.getTriangles(this._renderer.rect,this._renderer.triangles),c.updateBuffer.call(c,e,this,i),c.updateTexture.call(c,e,this)),!this._clip||r?(e.bindBuffer(e.ARRAY_BUFFER,this._renderer.textureCoordsBuffer),e.vertexAttribPointer(i.textureCoords,2,e.FLOAT,!1,0,0),e.bindTexture(e.TEXTURE_2D,this._renderer.texture),e.uniformMatrix3fv(i.matrix,!1,this._renderer.matrix),e.bindBuffer(e.ARRAY_BUFFER,this._renderer.buffer),e.vertexAttribPointer(i.position,2,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLES,0,6),this.flagReset()):void 0}},text:{updateCanvas:function(t){var i=this.canvas,n=this.ctx,r=t._renderer.scale,s=t._stroke,o=t._linewidth*r,a=t._fill,l=t._renderer.opacity||t._opacity;i.width=Math.max(Math.ceil(t._renderer.rect.width*r),1),i.height=Math.max(Math.ceil(t._renderer.rect.height*r),1);var h=t._renderer.rect.centroid,u=h.x,h=h.y;n.clearRect(0,0,i.width,i.height),n.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" "),n.textAlign="center",n.textBaseline="middle",a&&(e.isString(a)?n.fillStyle=a:(c[a._renderer.type].render.call(a,n,t),n.fillStyle=a._renderer.gradient)),s&&(e.isString(s)?n.strokeStyle=s:(c[s._renderer.type].render.call(s,n,t),n.strokeStyle=s._renderer.gradient)),o&&(n.lineWidth=o),e.isNumber(l)&&(n.globalAlpha=l),n.save(),n.scale(r,r),n.translate(u,h),c.isHidden.test(a)||n.fillText(t.value,0,0),c.isHidden.test(s)||n.strokeText(t.value,0,0),n.restore()},getBoundingClientRect:function(t,e){var i=c.ctx;i.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" "),i.textAlign="center",i.textBaseline=t._baseline;var i=i.measureText(t._value).width,n=Math.max(t._size||t._leading);this._linewidth&&!c.isHidden.test(this._stroke)&&(n+=this._linewidth);var r=i/2,s=n/2;switch(c.alignments[t._alignment]||t._alignment){case c.alignments.left:e.left=0,e.right=i;break;case c.alignments.right:e.left=-i,e.right=0;break;default:e.left=-r,e.right=r}switch(t._baseline){case"bottom":e.top=-n,e.bottom=0;break;case"top":e.top=0,e.bottom=n;break;default:e.top=-s,e.bottom=s}e.width=i,e.height=n,e.centroid||(e.centroid={}),e.centroid.x=r,e.centroid.y=s},render:function(e,i,r){if(!this._visible||!this._opacity)return this;var s=this.parent,a=s._matrix.manual||s._flagMatrix,l=this._matrix.manual||this._flagMatrix,h=this._flagVertices||this._flagFill||this._fill instanceof t.LinearGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof t.RadialGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._stroke instanceof t.LinearGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof t.RadialGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._flagStroke||this._flagLinewidth||this._flagOpacity||s._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||!this._renderer.texture;return this._update(),(a||l)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,o),n(o,s._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*s._renderer.scale),h&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new t.Array(12)),this._renderer.opacity=this._opacity*s._renderer.opacity,c.text.getBoundingClientRect(this,this._renderer.rect),c.getTriangles(this._renderer.rect,this._renderer.triangles),c.updateBuffer.call(c,e,this,i),c.updateTexture.call(c,e,this)),!this._clip||r?(e.bindBuffer(e.ARRAY_BUFFER,this._renderer.textureCoordsBuffer),e.vertexAttribPointer(i.textureCoords,2,e.FLOAT,!1,0,0),e.bindTexture(e.TEXTURE_2D,this._renderer.texture),e.uniformMatrix3fv(i.matrix,!1,this._renderer.matrix),e.bindBuffer(e.ARRAY_BUFFER,this._renderer.buffer),e.vertexAttribPointer(i.position,2,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLES,0,6),this.flagReset()):void 0}},"linear-gradient":{render:function(t){if(t.canvas.getContext("2d")){if(this._update(),!this._renderer.gradient||this._flagEndPoints||this._flagStops)for(this._renderer.gradient=t.createLinearGradient(this.left._x,this.left._y,this.right._x,this.right._y),t=0;t<this.stops.length;t++){var e=this.stops[t];this._renderer.gradient.addColorStop(e._offset,e._color)}return this.flagReset()}}},"radial-gradient":{render:function(t){if(t.canvas.getContext("2d")){if(this._update(),!this._renderer.gradient||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops)for(this._renderer.gradient=t.createRadialGradient(this.center._x,this.center._y,0,this.focal._x,this.focal._y,this._radius),t=0;t<this.stops.length;t++){var e=this.stops[t];this._renderer.gradient.addColorStop(e._offset,e._color)}return this.flagReset()}}},getTriangles:function(t,e){var i=t.top,n=t.left,r=t.right,s=t.bottom;e[0]=n,e[1]=i,e[2]=r,e[3]=i,e[4]=n,e[5]=s,e[6]=n,e[7]=s,e[8]=r,e[9]=i,e[10]=r,e[11]=s},updateTexture:function(t,e){this[e._renderer.type].updateCanvas.call(c,e),e._renderer.texture&&t.deleteTexture(e._renderer.texture),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.textureCoordsBuffer),e._renderer.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,e._renderer.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),0>=this.canvas.width||0>=this.canvas.height||t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(t,i,n){e.isObject(i._renderer.buffer)&&t.deleteBuffer(i._renderer.buffer),i._renderer.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i._renderer.buffer),t.enableVertexAttribArray(n.position),t.bufferData(t.ARRAY_BUFFER,i._renderer.triangles,t.STATIC_DRAW),e.isObject(i._renderer.textureCoordsBuffer)&&t.deleteBuffer(i._renderer.textureCoordsBuffer),i._renderer.textureCoordsBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i._renderer.textureCoordsBuffer),t.enableVertexAttribArray(n.textureCoords),t.bufferData(t.ARRAY_BUFFER,this.uv,t.STATIC_DRAW)},program:{create:function(i,n){var r,s;if(r=i.createProgram(),e.each(n,function(t){i.attachShader(r,t)}),i.linkProgram(r),!i.getProgramParameter(r,i.LINK_STATUS))throw s=i.getProgramInfoLog(r),i.deleteProgram(r),new t.Utils.Error("unable to link program: "+s);return r}},shaders:{create:function(e,i,n){if(n=e.createShader(e[n]),e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw i=e.getShaderInfoLog(n),e.deleteShader(n),new t.Utils.Error("unable to compile shader "+n+": "+i);return n},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};c.ctx=c.canvas.getContext("2d");var h=t[t.Types.webgl]=function(i){var n,r;if(this.domElement=i.domElement||document.createElement("canvas"),this.scene=new t.Group,this.scene.parent=this,this._renderer={matrix:new t.Array(s),scale:1,opacity:1},this._flagMatrix=!0,i=e.defaults(i||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=i.overdraw,i=this.ctx=this.domElement.getContext("webgl",i)||this.domElement.getContext("experimental-webgl",i),!this.ctx)throw new t.Utils.Error("unable to create a webgl context. Try using another renderer.");n=c.shaders.create(i,c.shaders.vertex,c.shaders.types.vertex),r=c.shaders.create(i,c.shaders.fragment,c.shaders.types.fragment),this.program=c.program.create(i,[n,r]),i.useProgram(this.program),this.program.position=i.getAttribLocation(this.program,"a_position"),this.program.matrix=i.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=i.getAttribLocation(this.program,"a_textureCoords"),i.disable(i.DEPTH_TEST),i.enable(i.BLEND),i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA)};e.extend(h.prototype,i.Events,{setSize:function(t,i,n){return this.width=t,this.height=i,this.ratio=e.isUndefined(n)?a(this.ctx):n,this.domElement.width=t*this.ratio,this.domElement.height=i*this.ratio,e.extend(this.domElement.style,{width:t+"px",height:i+"px"}),t*=this.ratio,i*=this.ratio,this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,this.ctx.viewport(0,0,t,i),n=this.ctx.getUniformLocation(this.program,"u_resolution"),this.ctx.uniform2f(n,t,i),this},render:function(){var t=this.ctx;return this.overdraw||t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),c.group.render.call(this.scene,t,this.program),this._flagMatrix=!1,this}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i){var n=t.Shape=function(){this._renderer={},this.id=t.Identifier+t.uniqueId(),this.classList=[],this._matrix=new t.Matrix,this.translation=new t.Vector,this.translation.bind(t.Events.change,e.bind(n.FlagMatrix,this)),this.rotation=0,this.scale=1};e.extend(n,i.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(t){Object.defineProperty(t,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._flagMatrix=!0}}),Object.defineProperty(t,"scale",{get:function(){return this._scale},set:function(t){this._scale=t,this._flagScale=this._flagMatrix=!0}})}}),e.extend(n.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(t){return t.add(this),this},clone:function(){var t=new n;return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,e.each(n.Properties,function(e){t[e]=this[e]},this),t._update()},_update:function(t){return!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation),t&&this.parent&&this.parent._update&&this.parent._update(),this},flagReset:function(){return this._flagMatrix=this._flagScale=!1,this}}),n.MakeObservable(n.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){function i(e,i,n){var r,s,o,a,l,c,h,u,f=i.controls&&i.controls.right,d=e.controls&&e.controls.left;return r=i.x,l=i.y,s=(f||i).x,c=(f||i).y,o=(d||e).x,h=(d||e).y,a=e.x,u=e.y,f&&i._relative&&(s+=i.x,c+=i.y),d&&e._relative&&(o+=e.x,h+=e.y),t.Utils.getCurveLength(r,l,s,c,o,h,a,u,n)}function n(e,i,n){var r,s,o,a,l,c,h,u,f=i.controls&&i.controls.right,d=e.controls&&e.controls.left;return r=i.x,l=i.y,s=(f||i).x,c=(f||i).y,o=(d||e).x,h=(d||e).y,a=e.x,u=e.y,f&&i._relative&&(s+=i.x,c+=i.y),d&&e._relative&&(o+=e.x,h+=e.y),t.Utils.subdivide(r,l,s,c,o,h,a,u,n)}var r=Math.min,s=Math.max,o=Math.round,a=t.Utils.getComputedMatrix;e.each(t.Commands,function(){});var l=t.Path=function(e,i,n,r){t.Shape.call(this),this._renderer.type="path",this._closed=!!i,this._curved=!!n,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.opacity=this.linewidth=1,this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this._vertices=[],this.vertices=e,this.automatic=!r};e.extend(l,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),FlagVertices:function(){this._flagLength=this._flagVertices=!0},MakeObservable:function(i){t.Shape.MakeObservable(i),e.each(l.Properties.slice(0,8),function(t){var e="_"+t,n="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(i,t,{get:function(){return this[e]},set:function(t){this[e]=t,this[n]=!0}})}),Object.defineProperty(i,"length",{get:function(){return this._flagLength&&this._updateLength(),this._length}}),Object.defineProperty(i,"closed",{get:function(){return this._closed},set:function(t){this._closed=!!t,this._flagVertices=!0}}),Object.defineProperty(i,"curved",{get:function(){return this._curved},set:function(t){this._curved=!!t,this._flagVertices=!0}}),Object.defineProperty(i,"automatic",{get:function(){return this._automatic},set:function(t){if(t!==this._automatic){var i=(this._automatic=!!t)?"ignore":"listen";e.each(this.vertices,function(t){t[i]()})}}}),Object.defineProperty(i,"beginning",{get:function(){return this._beginning},set:function(t){this._beginning=r(s(t,0),this._ending),this._flagVertices=!0}}),Object.defineProperty(i,"ending",{get:function(){return this._ending},set:function(t){this._ending=r(s(t,this._beginning),1),this._flagVertices=!0}}),Object.defineProperty(i,"vertices",{get:function(){return this._collection},
set:function(i){var n=e.bind(l.FlagVertices,this),r=e.bind(function(e){for(var i=e.length;i--;)e[i].bind(t.Events.change,n);n()},this),s=e.bind(function(i){e.each(i,function(e){e.unbind(t.Events.change,n)},this),n()},this);this._collection&&this._collection.unbind(),this._collection=new t.Utils.Collection((i||[]).slice(0)),this._collection.bind(t.Events.insert,r),this._collection.bind(t.Events.remove,s),r(this._collection)}}),Object.defineProperty(i,"clip",{get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}})}}),e.extend(l.prototype,t.Shape.prototype,{_flagVertices:!0,_flagLength:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_flagClip:!1,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_clip:!1,clone:function(i){i=i||this.parent;var n=e.map(this.vertices,function(t){return t.clone()}),r=new l(n,this.closed,this.curved,!this.automatic);return e.each(t.Path.Properties,function(t){r[t]=this[t]},this),r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,i.add(r),r},toObject:function(){var i={vertices:e.map(this.vertices,function(t){return t.toObject()})};return e.each(t.Shape.Properties,function(t){i[t]=this[t]},this),i.translation=this.translation.toObject,i.rotation=this.rotation,i.scale=this.scale,i},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},corner:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},e.each(this.vertices,function(e){e.addSelf(t.centroid)}),this},center:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},e.each(this.vertices,function(e){e.subSelf(t.centroid)}),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(t){var e,i,n,o,l,c=1/0,h=-(1/0),u=1/0,f=-(1/0);for(this._update(!0),t=t?this._matrix:a(this),e=this.linewidth/2,i=this._vertices.length,l=0;i>l;l++)o=this._vertices[l],n=o.x,o=o.y,o=t.multiply(n,o,1),u=r(o.y-e,u),c=r(o.x-e,c),h=s(o.x+e,h),f=s(o.y+e,f);return{top:u,left:c,right:h,bottom:f,width:h-c,height:f-u}},getPointAt:function(i,n){var r,s,o,a,l,c,h,u,f,d,p,m;for(h=this.length*Math.min(Math.max(i,0),1),u=this.vertices.length,f=u-1,c=r=null,d=0,s=this._lengths.length,o=0;s>d;d++){if(o+this._lengths[d]>h){r=this.vertices[this.closed?t.Utils.mod(d,u):d],c=this.vertices[Math.min(Math.max(d-1,0),f)],h-=o,i=h/this._lengths[d];break}o+=this._lengths[d]}return e.isNull(r)||e.isNull(c)?null:(m=c.controls&&c.controls.right,p=r.controls&&r.controls.left,s=c.x,h=c.y,o=(m||c).x,u=(m||c).y,a=(p||r).x,f=(p||r).y,l=r.x,d=r.y,m&&c._relative&&(o+=c.x,u+=c.y),p&&r._relative&&(a+=r.x,f+=r.y),r=t.Utils.getPointOnCubicBezier(i,s,o,a,l),c=t.Utils.getPointOnCubicBezier(i,h,u,f,d),e.isObject(n)?(n.x=r,n.y=c,n):new t.Vector(r,c))},plot:function(){if(this.curved)return t.Utils.getCurveFromPoints(this._vertices,this.closed),this;for(var e=0;e<this._vertices.length;e++)this._vertices[e]._command=0===e?t.Commands.move:t.Commands.line;return this},subdivide:function(i){this._update();var r=this.vertices.length-1,s=this.vertices[r],o=this._closed||this.vertices[r]._command===t.Commands.close,a=[];return e.each(this.vertices,function(l,c){if(!(0>=c)||o)if(l.command===t.Commands.move)a.push(new t.Anchor(s.x,s.y)),c>0&&(a[a.length-1].command=t.Commands.line);else{var h=n(l,s,i);a=a.concat(h),e.each(h,function(e,i){e.command=0>=i&&s.command===t.Commands.move?t.Commands.move:t.Commands.line}),c>=r&&(this._closed&&this._automatic?(s=l,h=n(l,s,i),a=a.concat(h),e.each(h,function(e,i){e.command=0>=i&&s.command===t.Commands.move?t.Commands.move:t.Commands.line})):o&&a.push(new t.Anchor(l.x,l.y)),a[a.length-1].command=o?t.Commands.close:t.Commands.line)}s=l},this),this._curved=this._automatic=!1,this.vertices=a,this},_updateLength:function(n){this._update();var r=this.vertices.length-1,s=this.vertices[r],o=this._closed||this.vertices[r]._command===t.Commands.close,a=0;return e.isUndefined(this._lengths)&&(this._lengths=[]),e.each(this.vertices,function(e,l){0>=l&&!o||e.command===t.Commands.move?(s=e,this._lengths[l]=0):(this._lengths[l]=i(e,s,n),a+=this._lengths[l],l>=r&&o&&(s=e,this._lengths[l+1]=i(e,s,n),a+=this._lengths[l+1]),s=e)},this),this._length=a,this},_update:function(){if(this._flagVertices){var e,i=this.vertices.length-1;e=o(this._beginning*i),i=o(this._ending*i),this._vertices.length=0;for(var n=e;i+1>n;n++)e=this.vertices[n],this._vertices.push(e);this._automatic&&this.plot()}return t.Shape.prototype._update.apply(this,arguments),this},flagReset:function(){return this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,t.Shape.prototype.flagReset.call(this),this}}),l.MakeObservable(l.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Path,n=t.Line=function(e,n,r,s){r=(r-e)/2,s=(s-n)/2,i.call(this,[new t.Anchor(-r,-s),new t.Anchor(r,s)]),this.translation.set(e+r,n+s)};e.extend(n.prototype,i.prototype),i.MakeObservable(n.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Path,n=t.Rectangle=function(e,n,r,s){r/=2,s/=2,i.call(this,[new t.Anchor(-r,-s),new t.Anchor(r,-s),new t.Anchor(r,s),new t.Anchor(-r,s)],!0),this.translation.set(e,n)};e.extend(n.prototype,i.prototype),i.MakeObservable(n.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Path,n=2*Math.PI,r=Math.cos,s=Math.sin,o=t.Ellipse=function(o,a,l,c){e.isNumber(c)||(c=l);var h=t.Resolution,u=e.map(e.range(h),function(e){var i=e/h*n;return e=l*r(i),i=c*s(i),new t.Anchor(e,i)},this);i.call(this,u,!0,!0),this.translation.set(o,a)};e.extend(o.prototype,i.prototype),i.MakeObservable(o.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Path,n=2*Math.PI,r=Math.cos,s=Math.sin,o=t.Polygon=function(o,a,l,c){c=Math.max(c||0,3);var h=e.map(e.range(c),function(e){var i=n*((e+.5)/c)+Math.PI/2;return e=l*r(i),i=l*s(i),new t.Anchor(e,i)});i.call(this,h,!0),this.translation.set(o,a)};e.extend(o.prototype,i.prototype),i.MakeObservable(o.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Path,n=Math.PI,r=Math.PI/2,s=Math.cos,o=Math.sin,a=t.ArcSegment=function(e,a,l,c,h,u,f){h>u&&(u+=2*Math.PI),f=f||8,u-=h;var d=u/f,p=t.Commands.move,m=[];m.push(new t.Anchor(Math.sin(0)*c,Math.cos(0)*c,0,0,0,0,p));for(var g,_,y,v,b,x,p=t.Commands.curve,A=0;f+1>A;A++)g=A*d,_=o(g)*c,y=s(g)*c,v=o(g-r)*(d/n)*c,b=s(g-r)*(d/n)*c,x=o(g+r)*(d/n)*c,g=s(g+r)*(d/n)*c,0===A&&(v=b=0),A===f&&(x=g=0),m.push(new t.Anchor(_,y,v,b,x,g,p));for(A=0;f+1>A;A++)g=u-d*A,_=o(g)*l,y=s(g)*l,v=o(g-1.5*n)*(d/n)*l,b=s(g-1.5*n)*(d/n)*l,x=o(g+1.5*n)*(d/n)*l,g=s(g+1.5*n)*(d/n)*l,0===A&&(v=b=0),A===f&&(x=g=0),m.push(new t.Anchor(_,y,v,b,x,g,p));p=t.Commands.close,m.push(new t.Anchor(Math.sin(0)*c,Math.cos(0)*c,0,0,0,0,p)),i.call(this,m,!0,!1,!0),this.rotation=h,this.translation.set(e,a)};e.extend(a.prototype,i.prototype),i.MakeObservable(a.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Path,n=Math.PI,r=Math.cos,s=Math.sin,o=t.SineRing=function(e,o,a,l,c,h){var u=2*l+1,f=Math.PI/l;l=n*a/l/2,h=h||1;var d,p,m,g,_,y=[],v=n;y.push(new t.Anchor(s(v)*(a+c/2),r(v)*(a+c/2),0,0,0,0,t.Commands.move));for(var b=0;u>b;b++)v=f*b+n,0===b%2?(d=Math.sin(v)*(a+c/2),p=Math.cos(v)*(a+c/2)):(d=Math.sin(v)*(a-c/2),p=Math.cos(v)*(a-c/2)),m=Math.sin(v-Math.PI/2)*l*h,g=Math.cos(v-Math.PI/2)*l*h,_=Math.sin(v+Math.PI/2)*l*h,v=Math.cos(v+Math.PI/2)*l*h,0===b&&(m=g=0),b===u-1&&(_=v=0),y.push(new t.Anchor(d,p,m,g,_,v,t.Commands.curve));i.call(this,y,!0,!1,!0),this.translation.set(e,o)};e.extend(o.prototype,i.prototype),i.MakeObservable(o.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Path,n=2*Math.PI,r=Math.cos,s=Math.sin,o=t.Star=function(o,a,l,c,h){e.isNumber(c)||(c=l/2),(!e.isNumber(h)||0>=h)&&(h=5);var u=2*h;h=e.map(e.range(u),function(e){var i=(e-.5)/u*n,o=e%2?c:l;return e=o*r(i),i=o*s(i),new t.Anchor(e,i)}),i.call(this,h,!0),this.translation.set(o,a)};e.extend(o.prototype,i.prototype),i.MakeObservable(o.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){function i(i,n,r,s,o){var a=0,l=0,c=t.Resolution;new t.Anchor(n,r);var h=0>n?-s:s,u=0>r?-s:s;switch(o){case 1:a=-Math.PI/2,l=0;break;case 2:a=-Math.PI,l=-Math.PI/2;break;case 3:a=1.5*-Math.PI,l=-Math.PI;break;case 4:a=0,l=Math.PI/2}return o=e.map(e.range(c),function(e){var i=a+(l-a)*((c-e-0)/(c-0));return e=s*Math.cos(i)+n-h,i=s*Math.sin(i)+r-u,new t.Anchor(e,i)}).reverse(),i.concat(o)}var n=t.Path,r=t.RoundedRectangle=function(r,s,o,a,l){var c=o/2,h=a/2;e.isNumber(l)||(l=Math.floor(Math.min(o,a)/12)),o=[new t.Anchor(-c+l,-h),new t.Anchor(c-l,-h)],o=i(o,c,-h,l,1),o.push(new t.Anchor(c,h-l)),o=i(o,c,h,l,4),o.push(new t.Anchor(-c+l,h)),o=i(o,-c,h,l,3),o.push(new t.Anchor(-c,-h+l)),o=i(o,-c,-h,l,2),o.pop(),n.call(this,o,!0),this.translation.set(r,s)};e.extend(r.prototype,n.prototype),n.MakeObservable(r.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.Utils.getComputedMatrix;document.createElement("canvas").getContext("2d"),t.Text=function(i,n,r,s){return t.Shape.call(this),this._renderer.type="text",this.value=i,e.isNumber(n)&&(this.translation.x=n),e.isNumber(r)&&(this.translation.y=r),e.isObject(s)?void e.each(t.Text.Properties,function(t){t in s&&(this[t]=s[t])},this):this},e.extend(t.Text,{Properties:"value family size leading alignment fill stroke linewidth style weight decoration baseline opacity visible".split(" "),MakeObservable:function(i){t.Shape.MakeObservable(i),e.each(t.Text.Properties,function(t){var e="_"+t,n="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(i,t,{get:function(){return this[e]},set:function(t){this[e]=t,this[n]=!0}})}),Object.defineProperty(i,"clip",{get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}})}}),e.extend(t.Text.prototype,t.Shape.prototype,{_flagValue:!0,_flagFamily:!0,_flagSize:!0,_flagLeading:!0,_flagAlignment:!0,_flagBaseline:!0,_flagStyle:!0,_flagWeight:!0,_flagDecoration:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagClip:!1,_value:"",_family:"sans-serif",_size:13,_leading:17,_alignment:"center",_baseline:"middle",_style:"normal",_weight:500,_decoration:"none",_fill:"#000",_stroke:"transparent",_linewidth:1,_opacity:1,_visible:!0,_clip:!1,clone:function(i){i=i||this.parent;var n=new t.Text(this.value);return n.translation.copy(this.translation),n.rotation=this.rotation,n.scale=this.scale,e.each(t.Text.Properties,function(t){n[t]=this[t]},this),i.add(n),n},toObject:function(){var i={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return e.each(t.Text.Properties,function(t){i[t]=this[t]},this),i},noStroke:function(){return this.stroke="transparent",this},noFill:function(){return this.fill="transparent",this},getBoundingClientRect:function(t){return this._update(!0),t=(t?this._matrix:i(this)).multiply(0,0,1),{top:t.x,left:t.y,right:t.x,bottom:t.y,width:0,height:0}},flagReset:function(){return this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpaicty=this._flagVisible=this._flagClip=this._flagDecoration=this._flagBaseline=!1,t.Shape.prototype.flagReset.call(this),this}}),t.Text.MakeObservable(t.Text.prototype)}(Two,"function"!=typeof require||"function"==typeof define&&define.amd?_:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i){var n=t.Stop=function(t,i,r){this._renderer={},this.offset=e.isNumber(t)?t:0>=n.Index?0:1,this.opacity=e.isNumber(r)?r:1,this.color=e.isString(i)?i:0>=n.Index?"#fff":"#000",n.Index=(n.Index+1)%2};e.extend(n,{Index:0,Properties:["offset","opacity","color"],MakeObservable:function(i){e.each(n.Properties,function(e){var n="_"+e,r="_flag"+e.charAt(0).toUpperCase()+e.slice(1);Object.defineProperty(i,e,{get:function(){return this[n]},set:function(e){this[n]=e,this[r]=!0,this.trigger(t.Events.change)}})})}}),e.extend(n.prototype,i.Events,{clone:function(){var t=new n;return e.each(n.Properties,function(e){t[e]=this[e]},this),t},toObject:function(){var t={};return e.each(n.Properties,function(e){t[e]=this[e]},this),t},flagReset:function(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,this}}),n.MakeObservable(n.prototype);var r=t.Gradient=function(e){t.Shape.call(this),this._renderer.type="gradient",this.spread="pad",this.stops=e};e.extend(r,{Stop:n,Properties:["spread"],MakeObservable:function(i){t.Shape.MakeObservable(i),e.each(r.Properties,t.Utils.defineProperty,i),Object.defineProperty(i,"stops",{get:function(){return this._stops},set:function(i){var n=e.bind(r.FlagStops,this),s=e.bind(function(e){for(var i=e.length;i--;)e[i].bind(t.Events.change,n);n()},this),o=e.bind(function(i){e.each(i,function(e){e.unbind(t.Events.change,n)},this),n()},this);this._stops&&this._stops.unbind(),this._stops=new t.Utils.Collection((i||[]).slice(0)),this._stops.bind(t.Events.insert,s),this._stops.bind(t.Events.remove,o),s(this._stops)}})},FlagStops:function(){this._flagStops=!0}}),e.extend(r.prototype,t.Shape.prototype,{clone:function(i){i=i||this.parent;var n=e.map(this.stops,function(t){return t.clone()}),s=new r(n);return e.each(t.Gradient.Properties,function(t){s[t]=this[t]},this),s.translation.copy(this.translation),s.rotation=this.rotation,s.scale=this.scale,i.add(s),s},toObject:function(){var t={stops:e.map(this.stops,function(t){return t.toObject()})};return e.each(r.Properties,function(e){t[e]=this[e]},this),t},flagReset:function(){return this._flagSpread=this._flagStops=!1,t.Shape.prototype.flagReset.call(this),this}}),r.MakeObservable(r.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.LinearGradient=function(n,r,s,o,a){t.Gradient.call(this,a),this._renderer.type="linear-gradient",a=e.bind(i.FlagEndPoints,this),this.left=(new t.Vector).bind(t.Events.change,a),this.right=(new t.Vector).bind(t.Events.change,a),e.isNumber(n)&&(this.left.x=n),e.isNumber(r)&&(this.left.y=r),e.isNumber(s)&&(this.right.x=s),e.isNumber(o)&&(this.right.y=o)};e.extend(i,{Stop:t.Gradient.Stop,MakeObservable:function(e){t.Gradient.MakeObservable(e)},FlagEndPoints:function(){this._flagEndPoints=!0}}),e.extend(i.prototype,t.Gradient.prototype,{_flagEndPoints:!1,clone:function(n){n=n||this.parent;var r=e.map(this.stops,function(t){return t.clone()}),s=new i(this.left._x,this.left._y,this.right._x,this.right._y,r);return e.each(t.Gradient.Properties,function(t){s[t]=this[t]},this),n.add(s),s},toObject:function(){var e=t.Gradient.prototype.toObject.call(this);return e.left=this.left.toObject(),e.right=this.right.toObject(),e},flagReset:function(){return this._flagEndPoints=!1,t.Gradient.prototype.flagReset.call(this),this}}),i.MakeObservable(i.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){var i=t.RadialGradient=function(i,n,r,s,o,a){t.Gradient.call(this,s),this._renderer.type="radial-gradient",this.center=(new t.Vector).bind(t.Events.change,e.bind(function(){this._flagCenter=!0},this)),this.radius=e.isNumber(r)?r:20,this.focal=(new t.Vector).bind(t.Events.change,e.bind(function(){this._flagFocal=!0},this)),e.isNumber(i)&&(this.center.x=i),e.isNumber(n)&&(this.center.y=n),this.focal.copy(this.center),e.isNumber(o)&&(this.focal.x=o),e.isNumber(a)&&(this.focal.y=a)};e.extend(i,{Stop:t.Gradient.Stop,Properties:["radius"],MakeObservable:function(n){t.Gradient.MakeObservable(n),e.each(i.Properties,t.Utils.defineProperty,n)}}),e.extend(i.prototype,t.Gradient.prototype,{_flagEndPoints:!1,clone:function(n){n=n||this.parent;var r=e.map(this.stops,function(t){return t.clone()}),s=new i(this.center._x,this.center._y,this._radius,r,this.focal._x,this.focal._y);return e.each(t.Gradient.Properties.concat(i.Properties),function(t){s[t]=this[t]},this),n.add(s),s},toObject:function(){var n=t.Gradient.prototype.toObject.call(this);return e.each(i.Properties,function(t){n[t]=this[t]},this),n.center=this.center.toObject(),n.focal=this.focal.toObject(),n},flagReset:function(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,t.Gradient.prototype.flagReset.call(this),this}}),i.MakeObservable(i.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e){function i(t,i){var n,r=t.parent;r&&r.children.ids[t.id]&&(n=e.indexOf(r.children,t),r.children.splice(n,1),n=e.indexOf(r.additions,t),n>=0?r.additions.splice(n,1):(r.subtractions.push(t),r._flagSubtractions=!0)),i?(t.parent=i,this.additions.push(t),this._flagAdditions=!0):(n=e.indexOf(this.additions,t),n>=0?this.additions.splice(n,1):(this.subtractions.push(t),this._flagSubtractions=!0),delete t.parent)}var n=Math.min,r=Math.max,s=function(){t.Utils.Collection.apply(this,arguments),Object.defineProperty(this,"_events",{value:{},enumerable:!1}),this.ids={},this.on(t.Events.insert,this.attach),this.on(t.Events.remove,this.detach),s.prototype.attach.apply(this,arguments)};s.prototype=new t.Utils.Collection,s.constructor=s,e.extend(s.prototype,{attach:function(t){for(var e=0;e<t.length;e++)this.ids[t[e].id]=t[e];return this},detach:function(t){for(var e=0;e<t.length;e++)delete this.ids[t[e].id];return this}});var o=t.Group=function(){t.Shape.call(this,!0),this._renderer.type="group",this.additions=[],this.subtractions=[],this._children=[],this.children=arguments};e.extend(o,{Children:s,InsertChildren:function(t){for(var e=0;e<t.length;e++)i.call(this,t[e],this)},RemoveChildren:function(t){for(var e=0;e<t.length;e++)i.call(this,t[e])},OrderChildren:function(){this._flagOrder=!0},MakeObservable:function(i){var n=t.Path.Properties.slice(0),r=e.indexOf(n,"opacity");r>=0&&(n.splice(r,1),Object.defineProperty(i,"opacity",{get:function(){return this._opacity},set:function(t){this._flagOpacity=this._opacity!=t,this._opacity=t}})),t.Shape.MakeObservable(i),o.MakeGetterSetters(i,n),Object.defineProperty(i,"children",{get:function(){return this._collection},set:function(i){var n=e.bind(o.InsertChildren,this),r=e.bind(o.RemoveChildren,this),a=e.bind(o.OrderChildren,this);this._collection&&this._collection.unbind(),this._collection=new s(i),this._collection.bind(t.Events.insert,n),this._collection.bind(t.Events.remove,r),this._collection.bind(t.Events.order,a)}}),Object.defineProperty(i,"mask",{get:function(){return this._mask},set:function(t){this._mask=t,this._flagMask=!0,t.clip||(t.clip=!0)}})},MakeGetterSetters:function(t,i){e.isArray(i)||(i=[i]),e.each(i,function(e){o.MakeGetterSetter(t,e)})},MakeGetterSetter:function(t,i){var n="_"+i;Object.defineProperty(t,i,{get:function(){return this[n]},set:function(t){this[n]=t,e.each(this.children,function(e){e[i]=t})}})}}),e.extend(o.prototype,t.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_flagOrder:!1,_flagOpacity:!0,_flagMask:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_mask:null,clone:function(t){t=t||this.parent;var i=new o;return t.add(i),e.map(this.children,function(t){return t.clone(i)}),i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i},toObject:function(){var t={children:{},translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return e.each(this.children,function(e,i){t.children[i]=e.toObject()},this),t},corner:function(){var t=this.getBoundingClientRect(!0),e={x:t.left,y:t.top};return this.children.forEach(function(t){t.translation.subSelf(e)}),this},center:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},this.children.forEach(function(e){e.translation.subSelf(t.centroid)}),this},getById:function(t){var e=function(t,i){if(t.id===i)return t;if(t.children)for(var n=t.children.length;n--;){var r=e(t.children[n],i);if(r)return r}};return e(this,t)||null},getByClassName:function(t){var e=[],i=function(t,n){return-1!=t.classList.indexOf(n)?e.push(t):t.children&&t.children.forEach(function(t){i(t,n)}),e};return i(this,t)},getByType:function(e){var i=[],n=function(e,r){for(var s in e.children)e.children[s]instanceof r?i.push(e.children[s]):e.children[s]instanceof t.Group&&n(e.children[s],r);return i};return n(this,e)},add:function(t){t=t instanceof Array?t.slice():e.toArray(arguments);for(var i=0;i<t.length;i++)t[i]&&t[i].id&&this.children.push(t[i]);return this},remove:function(t){var i=this.parent;if(0>=arguments.length&&i)return i.remove(this),this;for(t=t instanceof Array?t.slice():e.toArray(arguments),i=0;i<t.length;i++)t[i]&&this.children.ids[t[i].id]&&this.children.splice(e.indexOf(this.children,t[i]),1);return this},getBoundingClientRect:function(t){var i;this._update(!0);var s=1/0,o=-(1/0),a=1/0,l=-(1/0);return this.children.forEach(function(c){/(linear-gradient|radial-gradient|gradient)/.test(c._renderer.type)||(i=c.getBoundingClientRect(t),e.isNumber(i.top)&&e.isNumber(i.left)&&e.isNumber(i.right)&&e.isNumber(i.bottom)&&(a=n(i.top,a),s=n(i.left,s),o=r(i.right,o),l=r(i.bottom,l)))},this),{top:a,left:s,right:o,bottom:l,width:o-s,height:l-a}},noFill:function(){return this.children.forEach(function(t){t.noFill()}),this},noStroke:function(){return this.children.forEach(function(t){t.noStroke()}),this},subdivide:function(){var t=arguments;return this.children.forEach(function(e){e.subdivide.apply(e,t)}),this},flagReset:function(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=!1,t.Shape.prototype.flagReset.call(this),this}}),o.MakeObservable(o.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame"));